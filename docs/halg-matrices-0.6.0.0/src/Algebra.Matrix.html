<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css"></link><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds, FlexibleContexts, FlexibleInstances, GADTs   #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE KindSignatures, MultiParamTypeClasses                         #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE NoMonomorphismRestriction, TypeFamilies, TypeSynonymInstances #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Matrix</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#delta"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#companion"><span class="hs-identifier hs-var">companion</span></a><span class="hs-special">,</span><span>
</span><a name="line-6"></a><span>                       </span><a href="Algebra.Matrix.html#gaussReduction"><span class="hs-identifier hs-var">gaussReduction</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#maxNorm"><span class="hs-identifier hs-var">maxNorm</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#rankWith"><span class="hs-identifier hs-var">rankWith</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#det"><span class="hs-identifier hs-var">det</span></a><span class="hs-special">,</span><span>
</span><a name="line-7"></a><span>                       </span><a href="Algebra.Matrix.html#inverse"><span class="hs-identifier hs-var">inverse</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#inverseWith"><span class="hs-identifier hs-var">inverseWith</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Algebra.Internal</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Algebra.LinkedMatrix.html"><span class="hs-identifier">Algebra.LinkedMatrix</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LM</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Algebra.Prelude.Core</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maxNorm</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">zero</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Lens</span><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">both</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">view</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">%~</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">_3</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad</span><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">when</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Matrix</span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">DM</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Vector</span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.Exts</span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Constraint</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Numeric.Algebra</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Additive</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">DecidableZero</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Numeric.Algebra</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoidal</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Multiplicative</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Numeric.Algebra</span><span>             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Unital</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Numeric.Algebra</span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">NA</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Numeric.Decidable.Zero</span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">NA</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Numeric.LinearAlgebra</span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LA</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Numeric.LinearAlgebra.Devel</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LA</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Prelude</span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">P</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-pragma">{-# ANN</span><span> </span><span class="hs-pragma">module</span><span> </span><span class="hs-pragma">&quot;HLint: ignore Redundant bang pattern&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">class</span><span> </span><a name="Matrix"><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier">Matrix</span></a></a><span> </span><a name="local-6989586621679286648"><a href="#local-6989586621679286648"><span class="hs-identifier">mat</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Elem</span><span> </span><a name="local-6989586621679286648"><a href="#local-6989586621679286648"><span class="hs-identifier">mat</span></a></a><span> </span><a name="local-6989586621679286649"><a href="#local-6989586621679286649"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constraint</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-identifier">cmap</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286650"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286651"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286650"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286651"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286650"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286651"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286652"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286652"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-identifier">fromLists</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286653"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679286653"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286653"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-identifier">fromCols</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286654"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286654"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286654"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-34"></a><span>  </span><a name="local-8214565720324061521"><a href="Algebra.Matrix.html#fromCols"><span class="hs-identifier">fromCols</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.Matrix.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-identifier">fromCols</span><span> </span><a name="local-6989586621679286681"><a href="#local-6989586621679286681"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr1</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#%3C%7C%7C%3E"><span class="hs-operator hs-var">&lt;||&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Algebra.Matrix.html#colVector"><span class="hs-identifier hs-var">colVector</span></a><span> </span><a href="#local-6989586621679286681"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-identifier">fromRows</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286655"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286655"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286655"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-37"></a><span>  </span><a name="local-8214565720324061522"><a href="Algebra.Matrix.html#fromRows"><span class="hs-identifier">fromRows</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.Matrix.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-identifier">fromRows</span><span> </span><a name="local-6989586621679286682"><a href="#local-6989586621679286682"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr1</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#%3C--%3E"><span class="hs-operator hs-var">&lt;--&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Algebra.Matrix.html#rowVector"><span class="hs-identifier hs-var">rowVector</span></a><span> </span><a href="#local-6989586621679286682"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-identifier">toCols</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286656"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286656"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286656"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-40"></a><span>  </span><a name="local-8214565720324061523"><a href="Algebra.Matrix.html#toCols"><span class="hs-identifier">toCols</span></a></a><span> </span><a name="local-6989586621679286683"><a href="#local-6989586621679286683"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Algebra.Matrix.html#getCol"><span class="hs-identifier hs-var">getCol</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679286683"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier hs-var">ncols</span></a><span> </span><a href="#local-6989586621679286683"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-identifier">toRows</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286657"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286657"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286657"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-42"></a><span>  </span><a name="local-8214565720324061524"><a href="Algebra.Matrix.html#toRows"><span class="hs-identifier">toRows</span></a></a><span> </span><a name="local-6989586621679286684"><a href="#local-6989586621679286684"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Algebra.Matrix.html#getRow"><span class="hs-identifier hs-var">getRow</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679286684"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a><span> </span><a href="#local-6989586621679286684"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-identifier">ncols</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286658"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-identifier">nrows</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286659"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-45"></a><span>  </span><span class="hs-identifier">identity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286660"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286660"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-46"></a><span>  </span><span class="hs-identifier">diag</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286661"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286661"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286661"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-identifier">getDiag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286662"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286662"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286662"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-identifier">trace</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286663"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286663"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286663"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-identifier">diagProd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286664"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286664"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286664"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-identifier">zero</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286665"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286665"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-identifier">colVector</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286666"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286666"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286666"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-identifier">rowVector</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286667"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286667"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286667"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-identifier">getCol</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286668"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286668"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286668"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-identifier">getRow</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286669"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286669"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">V.Vector</span><span> </span><a href="#local-6989586621679286669"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-55"></a><span>  </span><span class="hs-identifier">switchRows</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286670"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286670"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286670"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-56"></a><span>  </span><span class="hs-identifier">scaleRow</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286671"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286671"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286671"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286671"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-57"></a><span>  </span><span class="hs-identifier">combineRows</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286672"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286672"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286672"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286672"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-58"></a><span>  </span><span class="hs-identifier">trans</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286673"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286673"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286673"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-59"></a><span>  </span><span class="hs-identifier">buildMatrix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286674"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286674"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286674"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-60"></a><span>  </span><span class="hs-identifier">index</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286675"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286675"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679286675"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-61"></a><span>  </span><a name="local-8214565720324061542"><a href="Algebra.Matrix.html#index"><span class="hs-identifier">index</span></a></a><span> </span><a name="local-6989586621679286685"><a href="#local-6989586621679286685"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679286686"><a href="#local-6989586621679286686"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679286687"><a href="#local-6989586621679286687"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679286685"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679286685"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a><span> </span><a href="#local-6989586621679286687"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679286686"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679286686"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier hs-var">ncols</span></a><span> </span><a href="#local-6989586621679286687"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-62"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679286687"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286685"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679286686"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286676"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286676"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286676"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-65"></a><span>  </span><span class="hs-special">(</span><span class="hs-operator">&lt;||&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286677"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-66"></a><span>  </span><span class="hs-special">(</span><span class="hs-operator">&lt;--&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286678"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286678"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286678"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286678"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-67"></a><span>  </span><span class="hs-identifier">nonZeroRows</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">DecidableZero</span><span> </span><a href="#local-6989586621679286679"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286679"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286679"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-68"></a><span>  </span><a name="local-8214565720324061546"><a href="Algebra.Matrix.html#nonZeroRows"><span class="hs-identifier">nonZeroRows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">NA.isZero</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Algebra.Matrix.html#toRows"><span class="hs-identifier hs-var">toRows</span></a><span>
</span><a name="line-69"></a><span>  </span><span class="hs-identifier">nonZeroCols</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">DecidableZero</span><span> </span><a href="#local-6989586621679286680"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286680"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679286648"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679286680"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-70"></a><span>  </span><a name="local-8214565720324061547"><a href="Algebra.Matrix.html#nonZeroCols"><span class="hs-identifier">nonZeroCols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.any</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">NA.isZero</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Algebra.Matrix.html#toCols"><span class="hs-identifier hs-var">toCols</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-keyword">instance</span><span> </span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><span class="hs-identifier hs-type">DM.Matrix</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-73"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier hs-type">DM.Matrix</span><span> </span><a href="#local-6989586621679287099"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">P.Num</span><span> </span><a href="#local-6989586621679287099"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-74"></a><span>  </span><a name="local-8214565720324061519"><a href="Algebra.Matrix.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.zero</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-75"></a><span>  </span><a name="local-8214565720324061518"><a href="Algebra.Matrix.html#cmap"><span class="hs-identifier">cmap</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span>
</span><a name="line-76"></a><span>  </span><a name="local-8214565720324061520"><a href="Algebra.Matrix.html#fromLists"><span class="hs-identifier">fromLists</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.fromLists</span><span>
</span><a name="line-77"></a><span>  </span><a name="local-8214565720324061525"><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier">ncols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DM.ncols</span><span>
</span><a name="line-78"></a><span>  </span><a name="local-8214565720324061526"><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier">nrows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DM.nrows</span><span>
</span><a name="line-79"></a><span>  </span><a name="local-8214565720324061540"><a href="Algebra.Matrix.html#trans"><span class="hs-identifier">trans</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.transpose</span><span>
</span><a name="line-80"></a><span>  </span><a name="local-8214565720324061527"><a href="Algebra.Matrix.html#identity"><span class="hs-identifier">identity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.identity</span><span>
</span><a name="line-81"></a><span>  </span><a name="local-8214565720324061528"><a href="Algebra.Matrix.html#diag"><span class="hs-identifier">diag</span></a></a><span> </span><a name="local-6989586621679287096"><a href="#local-6989586621679287096"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.matrix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.length</span><span> </span><a href="#local-6989586621679287096"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.length</span><span> </span><a href="#local-6989586621679287096"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679287097"><a href="#local-6989586621679287097"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679287098"><a href="#local-6989586621679287098"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679287097"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679287098"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679287096"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">V.!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287097"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-83"></a><span>  </span><a name="local-8214565720324061529"><a href="Algebra.Matrix.html#getDiag"><span class="hs-identifier">getDiag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.getDiag</span><span>
</span><a name="line-84"></a><span>  </span><a name="local-8214565720324061530"><a href="Algebra.Matrix.html#trace"><span class="hs-identifier">trace</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.trace</span><span>
</span><a name="line-85"></a><span>  </span><a name="local-8214565720324061531"><a href="Algebra.Matrix.html#diagProd"><span class="hs-identifier">diagProd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.diagProd</span><span>
</span><a name="line-86"></a><span>  </span><a name="local-8214565720324061532"><a href="Algebra.Matrix.html#zero"><span class="hs-identifier">zero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.zero</span><span>
</span><a name="line-87"></a><span>  </span><a name="local-8214565720324061533"><a href="Algebra.Matrix.html#colVector"><span class="hs-identifier">colVector</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.colVector</span><span>
</span><a name="line-88"></a><span>  </span><a name="local-8214565720324061534"><a href="Algebra.Matrix.html#rowVector"><span class="hs-identifier">rowVector</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.rowVector</span><span>
</span><a name="line-89"></a><span>  </span><a name="local-8214565720324061535"><a href="Algebra.Matrix.html#getCol"><span class="hs-identifier">getCol</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.getCol</span><span>
</span><a name="line-90"></a><span>  </span><a name="local-8214565720324061536"><a href="Algebra.Matrix.html#getRow"><span class="hs-identifier">getRow</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.getRow</span><span>
</span><a name="line-91"></a><span>  </span><a name="local-8214565720324061537"><a href="Algebra.Matrix.html#switchRows"><span class="hs-identifier">switchRows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.switchRows</span><span>
</span><a name="line-92"></a><span>  </span><a name="local-8214565720324061539"><a href="Algebra.Matrix.html#combineRows"><span class="hs-identifier">combineRows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.combineRows</span><span>
</span><a name="line-93"></a><span>  </span><a name="local-8214565720324061538"><a href="Algebra.Matrix.html#scaleRow"><span class="hs-identifier">scaleRow</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.scaleRow</span><span>
</span><a name="line-94"></a><span>  </span><a name="local-8214565720324061541"><a href="Algebra.Matrix.html#buildMatrix"><span class="hs-identifier">buildMatrix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">DM.matrix</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">DM.!</span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720324061544"><a href="Algebra.Matrix.html#%3C%7C%7C%3E"><span class="hs-operator">&lt;||&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">DM.&lt;|&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720324061545"><a href="Algebra.Matrix.html#%3C--%3E"><span class="hs-operator">&lt;--&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">DM.&lt;-&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-identifier">swapIJ</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679287165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679287165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287165"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-100"></a><a name="swapIJ"><a href="Algebra.Matrix.html#swapIJ"><span class="hs-identifier">swapIJ</span></a></a><span> </span><a name="local-6989586621679287166"><a href="#local-6989586621679287166"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679287167"><a href="#local-6989586621679287167"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679287168"><a href="#local-6989586621679287168"><span class="hs-identifier">k</span></a></a><span>
</span><a name="line-101"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679287168"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679287166"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679287167"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-102"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679287168"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679287167"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679287166"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-103"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679287168"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-keyword">instance</span><span> </span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><span class="hs-identifier hs-type">LA.Matrix</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier hs-type">LA.Matrix</span><span> </span><a href="#local-6989586621679287095"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">P.Num</span><span> </span><a href="#local-6989586621679287095"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">LA.Numeric</span><span>  </span><a href="#local-6989586621679287095"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">LA.Element</span><span> </span><a href="#local-6989586621679287095"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">LA.Container</span><span> </span><span class="hs-identifier hs-type">LA.Vector</span><span> </span><a href="#local-6989586621679287095"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>  </span><a name="local-8214565720324061519"><a href="Algebra.Matrix.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.fromLists</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-108"></a><span>  </span><a name="local-8214565720324061520"><a href="Algebra.Matrix.html#fromLists"><span class="hs-identifier">fromLists</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.fromLists</span><span>
</span><a name="line-109"></a><span>  </span><a name="local-8214565720324061518"><a href="Algebra.Matrix.html#cmap"><span class="hs-identifier">cmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.cmap</span><span>
</span><a name="line-110"></a><span>  </span><a name="local-8214565720324061525"><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier">ncols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.cols</span><span>
</span><a name="line-111"></a><span>  </span><a name="local-8214565720324061526"><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier">nrows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.rows</span><span>
</span><a name="line-112"></a><span>  </span><a name="local-8214565720324061540"><a href="Algebra.Matrix.html#trans"><span class="hs-identifier">trans</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.tr</span><span>
</span><a name="line-113"></a><span>  </span><a name="local-8214565720324061527"><a href="Algebra.Matrix.html#identity"><span class="hs-identifier">identity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.ident</span><span>
</span><a name="line-114"></a><span>  </span><a name="local-8214565720324061521"><a href="Algebra.Matrix.html#fromCols"><span class="hs-identifier">fromCols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.fromColumns</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LA.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.toList</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>  </span><a name="local-8214565720324061528"><a href="Algebra.Matrix.html#diag"><span class="hs-identifier">diag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.diag</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.toList</span><span>
</span><a name="line-116"></a><span>  </span><a name="local-8214565720324061529"><a href="Algebra.Matrix.html#getDiag"><span class="hs-identifier">getDiag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.toList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.takeDiag</span><span>
</span><a name="line-117"></a><span>  </span><a name="local-8214565720324061530"><a href="Algebra.Matrix.html#trace"><span class="hs-identifier">trace</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.sumElements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.takeDiag</span><span>
</span><a name="line-118"></a><span>  </span><a name="local-8214565720324061531"><a href="Algebra.Matrix.html#diagProd"><span class="hs-identifier">diagProd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.prodElements</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.takeDiag</span><span>
</span><a name="line-119"></a><span>  </span><a name="local-8214565720324061532"><a href="Algebra.Matrix.html#zero"><span class="hs-identifier">zero</span></a></a><span> </span><a name="local-6989586621679286705"><a href="#local-6989586621679286705"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679286706"><a href="#local-6989586621679286706"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.konst</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286705"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679286706"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>  </span><a name="local-8214565720324061533"><a href="Algebra.Matrix.html#colVector"><span class="hs-identifier">colVector</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.asColumn</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.toList</span><span>
</span><a name="line-121"></a><span>  </span><a name="local-8214565720324061534"><a href="Algebra.Matrix.html#rowVector"><span class="hs-identifier">rowVector</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.asRow</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.toList</span><span>
</span><a name="line-122"></a><span>  </span><a name="local-8214565720324061523"><a href="Algebra.Matrix.html#toCols"><span class="hs-identifier">toCols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.toList</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.toColumns</span><span>
</span><a name="line-123"></a><span>  </span><a name="local-8214565720324061524"><a href="Algebra.Matrix.html#toRows"><span class="hs-identifier">toRows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.toList</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.toRows</span><span>
</span><a name="line-124"></a><span>  </span><a name="local-8214565720324061535"><a href="Algebra.Matrix.html#getCol"><span class="hs-identifier">getCol</span></a></a><span> </span><a name="local-6989586621679286707"><a href="#local-6989586621679286707"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.toList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286707"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.toColumns</span><span>
</span><a name="line-125"></a><span>  </span><a name="local-8214565720324061536"><a href="Algebra.Matrix.html#getRow"><span class="hs-identifier">getRow</span></a></a><span> </span><a name="local-6989586621679286708"><a href="#local-6989586621679286708"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">V.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.toList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286708"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">LA.toRows</span><span>
</span><a name="line-126"></a><span>  </span><a name="local-8214565720324061537"><a href="Algebra.Matrix.html#switchRows"><span class="hs-identifier">switchRows</span></a></a><span> </span><a name="local-6989586621679286709"><a href="#local-6989586621679286709"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679286710"><a href="#local-6989586621679286710"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679286711"><a href="#local-6989586621679286711"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679286711"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">LA.?</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#swapIJ"><span class="hs-identifier hs-var">swapIJ</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286709"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286710"><span class="hs-identifier hs-var">j</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span> </span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a><span> </span><a href="#local-6989586621679286711"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-127"></a><span>  </span><a name="local-8214565720324061539"><a href="Algebra.Matrix.html#combineRows"><span class="hs-identifier">combineRows</span></a></a><span> </span><a name="local-6989586621679286712"><a href="#local-6989586621679286712"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679286713"><a href="#local-6989586621679286713"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679286714"><a href="#local-6989586621679286714"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679286715"><a href="#local-6989586621679286715"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.mapMatrixWithIndex</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679286716"><a href="#local-6989586621679286716"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><a name="local-6989586621679286717"><a href="#local-6989586621679286717"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679286718"><a href="#local-6989586621679286718"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679286716"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679286712"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679286713"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">P.*</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286715"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286714"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679286717"><span class="hs-identifier hs-var">l</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">P.+</span><span> </span><a href="#local-6989586621679286718"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679286718"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679286715"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-128"></a><span>  </span><a name="local-8214565720324061541"><a href="Algebra.Matrix.html#buildMatrix"><span class="hs-identifier">buildMatrix</span></a></a><span> </span><a name="local-6989586621679286719"><a href="#local-6989586621679286719"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679286720"><a href="#local-6989586621679286720"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679286721"><a href="#local-6989586621679286721"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.build</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286719"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679286720"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679286834"><a href="#local-6989586621679286834"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679286835"><a href="#local-6989586621679286835"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679286721"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#toIntLA"><span class="hs-identifier hs-var">toIntLA</span></a><span> </span><a href="#local-6989586621679286834"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#toIntLA"><span class="hs-identifier hs-var">toIntLA</span></a><span> </span><a href="#local-6989586621679286835"><span class="hs-identifier hs-var">j</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>  </span><a name="local-8214565720324061538"><a href="Algebra.Matrix.html#scaleRow"><span class="hs-identifier">scaleRow</span></a></a><span> </span><a name="local-6989586621679286836"><a href="#local-6989586621679286836"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679286837"><a href="#local-6989586621679286837"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">LA.mutable</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679287084"><a href="#local-6989586621679287084"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679287085"><a href="#local-6989586621679287085"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679287086"><a href="#local-6989586621679287086"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-130"></a><span>    </span><a name="local-6989586621679287087"><a href="#local-6989586621679287087"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">LA.readMatrix</span><span> </span><a href="#local-6989586621679287086"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679287084"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679287085"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-131"></a><span>    </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287084"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679286837"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-132"></a><span>      </span><span class="hs-identifier hs-var">LA.writeMatrix</span><span> </span><a href="#local-6989586621679287086"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679287084"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679287085"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286836"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">P.*</span><span> </span><a href="#local-6989586621679287087"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>  </span><a name="local-6989586621679287088"><a href="#local-6989586621679287088"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">!</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679287089"><a href="#local-6989586621679287089"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679287090"><a href="#local-6989586621679287090"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679287088"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">LA.atIndex</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287089"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287090"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>  </span><a name="local-6989586621679287091"><a href="#local-6989586621679287091"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-8214565720324061544"><a href="Algebra.Matrix.html#%3C%7C%7C%3E"><span class="hs-operator">&lt;||&gt;</span></a></a><span> </span><a name="local-6989586621679287092"><a href="#local-6989586621679287092"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.fromColumns</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">LA.toColumns</span><span> </span><a href="#local-6989586621679287091"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">LA.toColumns</span><span> </span><a href="#local-6989586621679287092"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-135"></a><span>  </span><a name="local-6989586621679287093"><a href="#local-6989586621679287093"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-8214565720324061545"><a href="Algebra.Matrix.html#%3C--%3E"><span class="hs-operator">&lt;--&gt;</span></a></a><span> </span><a name="local-6989586621679287094"><a href="#local-6989586621679287094"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LA.fromRows</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">LA.toRows</span><span> </span><a href="#local-6989586621679287093"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">LA.toRows</span><span> </span><a href="#local-6989586621679287094"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-identifier">toIntLA</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LA.Container</span><span> </span><span class="hs-identifier hs-type">LA.Matrix</span><span> </span><a href="#local-6989586621679287164"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679287164"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-138"></a><a name="toIntLA"><a href="Algebra.Matrix.html#toIntLA"><span class="hs-identifier">toIntLA</span></a></a><span> </span><a name="local-6989586621679287169"><a href="#local-6989586621679287169"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">LA.toZ</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">LA.&gt;&lt;</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679287169"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">LA.atIndex</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-keyword">instance</span><span> </span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="Algebra.LinkedMatrix.html#Matrix"><span class="hs-identifier hs-type">LM.Matrix</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Elem</span><span> </span><a href="Algebra.LinkedMatrix.html#Matrix"><span class="hs-identifier hs-type">LM.Matrix</span></a><span> </span><a href="#local-6989586621679286704"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CoeffRing</span><span> </span><a href="#local-6989586621679286704"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Unital</span><span> </span><a href="#local-6989586621679286704"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoidal</span><span> </span><a href="#local-6989586621679286704"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Multiplicative</span><span> </span><a href="#local-6989586621679286704"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Additive</span><span> </span><a href="#local-6989586621679286704"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>  </span><a name="local-8214565720324061518"><a href="Algebra.Matrix.html#cmap"><span class="hs-identifier">cmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#cmap"><span class="hs-identifier hs-var">LM.cmap</span></a><span>
</span><a name="line-143"></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679286688"><a href="#local-6989586621679286688"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679286689"><a href="#local-6989586621679286689"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679286688"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Algebra.LinkedMatrix.html#%21"><span class="hs-operator hs-var">LM.!</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286689"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">both</span><span> </span><span class="hs-operator hs-var">%~</span><span> </span><span class="hs-identifier hs-var">pred</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>  </span><a name="local-8214565720324061542"><a href="Algebra.Matrix.html#index"><span class="hs-identifier">index</span></a></a><span> </span><a name="local-6989586621679286690"><a href="#local-6989586621679286690"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679286691"><a href="#local-6989586621679286691"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#index"><span class="hs-identifier hs-var">LM.index</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286690"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286691"><span class="hs-identifier hs-var">j</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>  </span><a name="local-8214565720324061519"><a href="Algebra.Matrix.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#empty"><span class="hs-identifier hs-var">LM.empty</span></a><span>
</span><a name="line-146"></a><span>  </span><a name="local-8214565720324061541"><a href="Algebra.Matrix.html#buildMatrix"><span class="hs-identifier">buildMatrix</span></a></a><span> </span><a name="local-6989586621679286692"><a href="#local-6989586621679286692"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679286693"><a href="#local-6989586621679286693"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679286694"><a href="#local-6989586621679286694"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#fromList"><span class="hs-identifier hs-var">LM.fromList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679286696"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679286695"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679286694"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286696"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679286695"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679286695"><a href="#local-6989586621679286695"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679286693"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679286696"><a href="#local-6989586621679286696"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679286692"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-147"></a><span>  </span><a name="local-8214565720324061540"><a href="Algebra.Matrix.html#trans"><span class="hs-identifier">trans</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#transpose"><span class="hs-identifier hs-var">LM.transpose</span></a><span>
</span><a name="line-148"></a><span>  </span><a name="local-8214565720324061539"><a href="Algebra.Matrix.html#combineRows"><span class="hs-identifier">combineRows</span></a></a><span> </span><a name="local-6989586621679286697"><a href="#local-6989586621679286697"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679286698"><a href="#local-6989586621679286698"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679286699"><a href="#local-6989586621679286699"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#combineRows"><span class="hs-identifier hs-var">LM.combineRows</span></a><span> </span><a href="#local-6989586621679286698"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286699"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286697"><span class="hs-identifier hs-var">j</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>  </span><a name="local-8214565720324061537"><a href="Algebra.Matrix.html#switchRows"><span class="hs-identifier">switchRows</span></a></a><span> </span><a name="local-6989586621679286700"><a href="#local-6989586621679286700"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679286701"><a href="#local-6989586621679286701"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#switchRows"><span class="hs-identifier hs-var">LM.switchRows</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286700"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679286701"><span class="hs-identifier hs-var">j</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>  </span><a name="local-8214565720324061538"><a href="Algebra.Matrix.html#scaleRow"><span class="hs-identifier">scaleRow</span></a></a><span> </span><a name="local-6989586621679286702"><a href="#local-6989586621679286702"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679286703"><a href="#local-6989586621679286703"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#scaleRow"><span class="hs-identifier hs-var">LM.scaleRow</span></a><span> </span><a href="#local-6989586621679286702"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pred</span><span> </span><a href="#local-6989586621679286703"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>  </span><a name="local-8214565720324061532"><a href="Algebra.Matrix.html#zero"><span class="hs-identifier">zero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#zeroMat"><span class="hs-identifier hs-var">LM.zeroMat</span></a><span>
</span><a name="line-152"></a><span>  </span><a name="local-8214565720324061527"><a href="Algebra.Matrix.html#identity"><span class="hs-identifier">identity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#identity"><span class="hs-identifier hs-var">LM.identity</span></a><span>
</span><a name="line-153"></a><span>  </span><a name="local-8214565720324061528"><a href="Algebra.Matrix.html#diag"><span class="hs-identifier">diag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#diag"><span class="hs-identifier hs-var">LM.diag</span></a><span>
</span><a name="line-154"></a><span>  </span><a name="local-8214565720324061529"><a href="Algebra.Matrix.html#getDiag"><span class="hs-identifier">getDiag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#getDiag"><span class="hs-identifier hs-var">LM.getDiag</span></a><span>
</span><a name="line-155"></a><span>  </span><a name="local-8214565720324061531"><a href="Algebra.Matrix.html#diagProd"><span class="hs-identifier">diagProd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#diagProd"><span class="hs-identifier hs-var">LM.diagProd</span></a><span>
</span><a name="line-156"></a><span>  </span><a name="local-8214565720324061530"><a href="Algebra.Matrix.html#trace"><span class="hs-identifier">trace</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#trace"><span class="hs-identifier hs-var">LM.trace</span></a><span>
</span><a name="line-157"></a><span>  </span><a name="local-8214565720324061536"><a href="Algebra.Matrix.html#getRow"><span class="hs-identifier">getRow</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#getRow"><span class="hs-identifier hs-var">LM.getRow</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">pred</span><span>
</span><a name="line-158"></a><span>  </span><a name="local-8214565720324061535"><a href="Algebra.Matrix.html#getCol"><span class="hs-identifier">getCol</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#getCol"><span class="hs-identifier hs-var">LM.getCol</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">pred</span><span>
</span><a name="line-159"></a><span>  </span><a name="local-8214565720324061526"><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier">nrows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#nrows"><span class="hs-identifier hs-var">LM.nrows</span></a><span>
</span><a name="line-160"></a><span>  </span><a name="local-8214565720324061525"><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier">ncols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#ncols"><span class="hs-identifier hs-var">LM.ncols</span></a><span>
</span><a name="line-161"></a><span>  </span><a name="local-8214565720324061520"><a href="Algebra.Matrix.html#fromLists"><span class="hs-identifier">fromLists</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#fromLists"><span class="hs-identifier hs-var">LM.fromLists</span></a><span>
</span><a name="line-162"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720324061544"><a href="Algebra.Matrix.html#%3C%7C%7C%3E"><span class="hs-operator">&lt;||&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Algebra.LinkedMatrix.html#%3C%7C%7C%3E"><span class="hs-operator hs-var">LM.&lt;||&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720324061545"><a href="Algebra.Matrix.html#%3C--%3E"><span class="hs-operator">&lt;--&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Algebra.LinkedMatrix.html#%3C--%3E"><span class="hs-operator hs-var">LM.&lt;--&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>  </span><a name="local-8214565720324061534"><a href="Algebra.Matrix.html#rowVector"><span class="hs-identifier">rowVector</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#rowVector"><span class="hs-identifier hs-var">LM.rowVector</span></a><span>
</span><a name="line-165"></a><span>  </span><a name="local-8214565720324061533"><a href="Algebra.Matrix.html#colVector"><span class="hs-identifier">colVector</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#colVector"><span class="hs-identifier hs-var">LM.colVector</span></a><span>
</span><a name="line-166"></a><span>  </span><a name="local-8214565720324061546"><a href="Algebra.Matrix.html#nonZeroRows"><span class="hs-identifier">nonZeroRows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#nonZeroRows"><span class="hs-identifier hs-var">LM.nonZeroRows</span></a><span>
</span><a name="line-167"></a><span>  </span><a name="local-8214565720324061547"><a href="Algebra.Matrix.html#nonZeroCols"><span class="hs-identifier">nonZeroCols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.LinkedMatrix.html#nonZeroCols"><span class="hs-identifier hs-var">LM.nonZeroCols</span></a><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-identifier">delta</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NA.Monoidal</span><span> </span><a href="#local-6989586621679287163"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NA.Unital</span><span> </span><a href="#local-6989586621679287163"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287163"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-170"></a><a name="delta"><a href="Algebra.Matrix.html#delta"><span class="hs-identifier">delta</span></a></a><span> </span><a name="local-6989586621679287170"><a href="#local-6989586621679287170"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679287171"><a href="#local-6989586621679287171"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679287170"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679287171"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NA.one</span><span>
</span><a name="line-171"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NA.zero</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">companion</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">KnownNat</span><span> </span><a href="#local-6989586621679287114"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CoeffRing</span><span> </span><a href="#local-6989586621679287115"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="#local-6989586621679287116"><span class="hs-identifier hs-type">mat</span></a><span class="hs-special">,</span><span>
</span><a name="line-174"></a><span>              </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679287116"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287115"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IsMonomialOrder</span><span> </span><a href="#local-6989586621679287114"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679287117"><span class="hs-identifier hs-type">ord</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ordinal</span><span> </span><a href="#local-6989586621679287114"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">OrderedPolynomial</span><span> </span><a href="#local-6989586621679287115"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679287117"><span class="hs-identifier hs-type">ord</span></a><span> </span><a href="#local-6989586621679287114"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287116"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287115"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-176"></a><a name="companion"><a href="Algebra.Matrix.html#companion"><span class="hs-identifier">companion</span></a></a><span> </span><a name="local-6989586621679287172"><a href="#local-6989586621679287172"><span class="hs-identifier">odn</span></a></a><span> </span><a name="local-6989586621679287173"><a href="#local-6989586621679287173"><span class="hs-identifier">poly</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679287174"><a href="#local-6989586621679287174"><span class="hs-identifier">deg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">totalDegree'</span><span> </span><a href="#local-6989586621679287173"><span class="hs-identifier hs-var">poly</span></a><span>
</span><a name="line-178"></a><span>      </span><a name="local-6989586621679287175"><a href="#local-6989586621679287175"><span class="hs-identifier">vx</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">leadingMonomial</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">var</span><span> </span><a href="#local-6989586621679287172"><span class="hs-identifier hs-var">odn</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">asTypeOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679287173"><span class="hs-identifier hs-var">poly</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="Algebra.Matrix.html#buildMatrix"><span class="hs-identifier hs-var">buildMatrix</span></a><span> </span><a href="#local-6989586621679287174"><span class="hs-identifier hs-var">deg</span></a><span> </span><a href="#local-6989586621679287174"><span class="hs-identifier hs-var">deg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679287176"><a href="#local-6989586621679287176"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679287177"><a href="#local-6989586621679287177"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-180"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679287177"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679287177"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679287174"><span class="hs-identifier hs-var">deg</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-181"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="Algebra.Matrix.html#delta"><span class="hs-identifier hs-var">delta</span></a><span> </span><a href="#local-6989586621679287176"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287177"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">NA.negate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">coeff</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NA.pow</span><span> </span><a href="#local-6989586621679287175"><span class="hs-identifier hs-var">vx</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679287176"><span class="hs-identifier hs-var">j</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">NA.Natural</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679287173"><span class="hs-identifier hs-var">poly</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- | @gaussReduction a = (a', p)@ where @a'@ is row echelon form and @p@ is pivoting matrix.</span><span>
</span><a name="line-185"></a><span class="hs-identifier">gaussReduction</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="#local-6989586621679287112"><span class="hs-identifier hs-type">mat</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679287112"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Normed</span><span> </span><a href="#local-6989586621679287113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679287113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NA.Field</span><span> </span><a href="#local-6989586621679287113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679287112"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287113"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287112"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287112"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-187"></a><a name="gaussReduction"><a href="Algebra.Matrix.html#gaussReduction"><span class="hs-identifier">gaussReduction</span></a></a><span> </span><a name="local-6989586621679287178"><a href="#local-6989586621679287178"><span class="hs-identifier">mat</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679287179"><a href="#local-6989586621679287179"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679287180"><a href="#local-6989586621679287180"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.Matrix.html#gaussReduction%27"><span class="hs-identifier hs-var">gaussReduction'</span></a><span> </span><a href="#local-6989586621679287178"><span class="hs-identifier hs-var">mat</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287179"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287180"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-comment">-- | @gaussReduction a = (a', p)@ where @a'@ is row echelon form and @p@ is pivoting matrix.</span><span>
</span><a name="line-191"></a><span class="hs-identifier">gaussReduction'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="#local-6989586621679287110"><span class="hs-identifier hs-type">mat</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679287110"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287111"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Normed</span><span> </span><a href="#local-6989586621679287111"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679287111"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NA.Field</span><span> </span><a href="#local-6989586621679287111"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679287110"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287111"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287110"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287111"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287110"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287111"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287111"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-193"></a><a name="gaussReduction%27"><a href="Algebra.Matrix.html#gaussReduction%27"><span class="hs-identifier">gaussReduction'</span></a></a><span> </span><a name="local-6989586621679287181"><a href="#local-6989586621679287181"><span class="hs-identifier">mat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;gaussRed&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><a href="#local-6989586621679287182"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679287181"><span class="hs-identifier hs-var">mat</span></a><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#identity"><span class="hs-identifier hs-var">identity</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a><span> </span><a href="#local-6989586621679287181"><span class="hs-identifier hs-var">mat</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">NA.one</span><span>
</span><a name="line-194"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-195"></a><span>    </span><a name="local-6989586621679287182"><a href="#local-6989586621679287182"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679287183"><a href="#local-6989586621679287183"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679287184"><a href="#local-6989586621679287184"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679287185"><a href="#local-6989586621679287185"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679287186"><a href="#local-6989586621679287186"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679287187"><a href="#local-6989586621679287187"><span class="hs-identifier">acc</span></a></a><span>
</span><a name="line-196"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a><span> </span><a href="#local-6989586621679287181"><span class="hs-identifier hs-var">mat</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679287184"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="Algebra.Matrix.html#ncols"><span class="hs-identifier hs-var">ncols</span></a><span> </span><a href="#local-6989586621679287181"><span class="hs-identifier hs-var">mat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287185"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287186"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287187"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-198"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679287188"><a href="#local-6989586621679287188"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679287189"><a href="#local-6989586621679287189"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maximumBy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">comparing</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">norm</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679287190"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287185"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287190"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287184"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679287190"><a href="#local-6989586621679287190"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">..</span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a><span> </span><a href="#local-6989586621679287181"><span class="hs-identifier hs-var">mat</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-199"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679287189"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">NA.zero</span><span>
</span><a name="line-200"></a><span>           </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679287182"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287184"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679287185"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679287186"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-identifier hs-var">NA.zero</span><span>
</span><a name="line-201"></a><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679287191"><a href="#local-6989586621679287191"><span class="hs-identifier">prc</span></a></a><span> </span><a name="local-6989586621679287195"><a href="#local-6989586621679287195"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679287196"><a href="#local-6989586621679287196"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679287197"><a href="#local-6989586621679287197"><span class="hs-identifier">p0</span></a></a><span>
</span><a name="line-202"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679287195"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679287191"><span class="hs-identifier hs-var">prc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287195"><span class="hs-identifier hs-var">l</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679287196"><span class="hs-identifier hs-var">a0</span></a><span> </span><a href="#local-6989586621679287197"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-203"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679287195"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="Algebra.Matrix.html#nrows"><span class="hs-identifier hs-var">nrows</span></a><span> </span><a href="#local-6989586621679287181"><span class="hs-identifier hs-var">mat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287196"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287197"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span>
</span><a name="line-205"></a><span>                        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679287198"><a href="#local-6989586621679287198"><span class="hs-identifier">coe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">NA.negate</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287196"><span class="hs-identifier hs-var">a0</span></a><span> </span><span class="hs-glyph">!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287195"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287184"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>                            </span><a name="local-6989586621679287199"><a href="#local-6989586621679287199"><span class="hs-identifier">a''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.Matrix.html#combineRows"><span class="hs-identifier hs-var">combineRows</span></a><span> </span><a href="#local-6989586621679287195"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679287198"><span class="hs-identifier hs-var">coe</span></a><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679287196"><span class="hs-identifier hs-var">a0</span></a><span>
</span><a name="line-207"></a><span>                            </span><a name="local-6989586621679287200"><a href="#local-6989586621679287200"><span class="hs-identifier">p''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Algebra.Matrix.html#combineRows"><span class="hs-identifier hs-var">combineRows</span></a><span> </span><a href="#local-6989586621679287195"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679287198"><span class="hs-identifier hs-var">coe</span></a><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679287197"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-208"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679287191"><span class="hs-identifier hs-var">prc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287195"><span class="hs-identifier hs-var">l</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679287199"><span class="hs-identifier hs-var">a''</span></a><span> </span><a href="#local-6989586621679287200"><span class="hs-identifier hs-var">p''</span></a><span>
</span><a name="line-209"></a><span>                    </span><span class="hs-special">(</span><a name="local-6989586621679287192"><a href="#local-6989586621679287192"><span class="hs-identifier">a'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679287193"><a href="#local-6989586621679287193"><span class="hs-identifier">p'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679287191"><span class="hs-identifier hs-var">prc</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#scaleRow"><span class="hs-identifier hs-var">scaleRow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NA.recip</span><span> </span><a href="#local-6989586621679287189"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Algebra.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679287188"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679287185"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span>                                     </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#scaleRow"><span class="hs-identifier hs-var">scaleRow</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NA.recip</span><span> </span><a href="#local-6989586621679287189"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Algebra.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679287188"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679287186"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span>                    </span><a name="local-6989586621679287194"><a href="#local-6989586621679287194"><span class="hs-identifier">offset</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679287188"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">NA.negate</span><span>
</span><a name="line-212"></a><span>                </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679287182"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287183"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287184"><span class="hs-identifier hs-var">j</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679287192"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679287193"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287194"><span class="hs-identifier hs-var">offset</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679287187"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-operator hs-var">NA.*</span><span> </span><a href="#local-6989586621679287189"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-identifier">det</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679287108"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287109"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679287109"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NA.Field</span><span> </span><a href="#local-6989586621679287109"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Normed</span><span> </span><a href="#local-6989586621679287109"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="#local-6989586621679287108"><span class="hs-identifier hs-type">mat</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679287108"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287109"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287109"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-216"></a><a name="det"><a href="Algebra.Matrix.html#det"><span class="hs-identifier">det</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">_3</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Algebra.Matrix.html#gaussReduction%27"><span class="hs-identifier hs-var">gaussReduction'</span></a><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-identifier">maxNorm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679287106"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287107"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Normed</span><span> </span><a href="#local-6989586621679287107"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="#local-6989586621679287106"><span class="hs-identifier hs-type">mat</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679287106"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287107"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Norm</span><span> </span><a href="#local-6989586621679287107"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-219"></a><a name="maxNorm"><a href="Algebra.Matrix.html#maxNorm"><span class="hs-identifier">maxNorm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maximum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">norm</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">V.toList</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Algebra.Matrix.html#toRows"><span class="hs-identifier hs-var">toRows</span></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-identifier">rankWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679287104"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287105"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CoeffRing</span><span> </span><a href="#local-6989586621679287105"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="#local-6989586621679287104"><span class="hs-identifier hs-type">mat</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287104"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287105"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287104"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287105"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287104"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287105"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-223"></a><a name="rankWith"><a href="Algebra.Matrix.html#rankWith"><span class="hs-identifier">rankWith</span></a></a><span> </span><a name="local-6989586621679287201"><a href="#local-6989586621679287201"><span class="hs-identifier">gauss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Algebra.Matrix.html#nonZeroRows"><span class="hs-identifier hs-var">nonZeroRows</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679287201"><span class="hs-identifier hs-var">gauss</span></a><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-identifier">inverse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Algebra.Matrix.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679287102"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287103"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679287103"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NA.Field</span><span> </span><a href="#local-6989586621679287103"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Normed</span><span> </span><a href="#local-6989586621679287103"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Algebra.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a><span> </span><a href="#local-6989586621679287102"><span class="hs-identifier hs-type">mat</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679287102"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287103"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287102"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287103"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-227"></a><a name="inverse"><a href="Algebra.Matrix.html#inverse"><span class="hs-identifier">inverse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Algebra.Matrix.html#gaussReduction"><span class="hs-identifier hs-var">gaussReduction</span></a><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-identifier">inverseWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287100"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679287100"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287101"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679287100"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287101"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287100"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679287100"><span class="hs-identifier hs-type">mat</span></a><span> </span><a href="#local-6989586621679287101"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-230"></a><a name="inverseWith"><a href="Algebra.Matrix.html#inverseWith"><span class="hs-identifier">inverseWith</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span>
</span><a name="line-231"></a></pre></body></html>