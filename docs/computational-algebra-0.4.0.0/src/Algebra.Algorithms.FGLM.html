<DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;=""><html xmlns="http://www.w3.org/1999/xhtml"><head><link href="style.css" type="text/css" rel="stylesheet"></link><script src="highlight.js" type="text/javascript"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds, FlexibleContexts, MultiParamTypeClasses #-}</span> <span></span> <a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude, TemplateHaskell                       #-}</span> <span></span> <a name="line-3"></a><span class="hs-keyword">module</span> <span></span> <span class="hs-identifier">Algebra</span> <span class="hs-operator">.</span> <span class="hs-identifier">Algorithms</span> <span class="hs-operator">.</span> <span class="hs-identifier">FGLM</span> <span></span> <span class="hs-special">(</span> <a href="Algebra.Algorithms.FGLM.html#FGLMEnv"><span class="hs-identifier hs-type">FGLMEnv</span> </a><span class="hs-special">(</span> <span class="hs-glyph">..</span> <span class="hs-special">)</span> <span class="hs-special">,</span> <span></span> <a href="Algebra.Algorithms.FGLM.html#lMap"><span class="hs-identifier hs-var">lMap</span> </a><span class="hs-special">,</span> <span></span> <a href="Algebra.Algorithms.FGLM.html#gLex"><span class="hs-identifier hs-var">gLex</span> </a><span class="hs-special">,</span> <span></span> <a href="Algebra.Algorithms.FGLM.html#bLex"><span class="hs-identifier hs-var">bLex</span> </a><span class="hs-special">,</span> <span></span> <a href="Algebra.Algorithms.FGLM.html#proced"><span class="hs-identifier hs-var">proced</span> </a><span class="hs-special">,</span> <span></span> <a name="line-4"></a><span></span> <a href="Algebra.Algorithms.FGLM.html#monomial"><span class="hs-identifier hs-var">monomial</span> </a><span class="hs-special">,</span> <span></span> <a href="Algebra.Algorithms.FGLM.html#look"><span class="hs-identifier hs-var">look</span> </a><span class="hs-special">,</span> <span></span> <span class="hs-special">(</span> <a href="Algebra.Algorithms.FGLM.html#.%3D%3D"><span class="hs-operator hs-var">.==</span> </a><span class="hs-special">)</span> <span class="hs-special">,</span> <span></span> <span class="hs-special">(</span> <a href="Algebra.Algorithms.FGLM.html#%25%3D%3D"><span class="hs-operator hs-var">%==</span> </a><span class="hs-special">)</span> <span class="hs-special">,</span> <span></span> <a href="Algebra.Algorithms.FGLM.html#image"><span class="hs-identifier hs-var">image</span> </a><span class="hs-special">,</span> <span></span> <a href="Algebra.Algorithms.FGLM.html#Machine"><span class="hs-identifier hs-type">Machine</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-5"></a><span class="hs-keyword">import</span> <span></span> <a href="Algebra.Ring.Polynomial.html"><span class="hs-identifier">Algebra</span> <span class="hs-operator">.</span> <span class="hs-identifier">Ring</span> <span class="hs-operator">.</span> <span class="hs-identifier">Polynomial</span> </a><span></span> <a name="line-6"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Control</span> <span class="hs-operator">.</span> <span class="hs-identifier">Lens</span> <span></span> <a name="line-7"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Control</span> <span class="hs-operator">.</span> <span class="hs-identifier">Monad</span> <span></span> <a name="line-8"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Control</span> <span class="hs-operator">.</span> <span class="hs-identifier">Monad</span> <span class="hs-operator">.</span> <span class="hs-identifier">Reader</span> <span></span> <a name="line-9"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Control</span> <span class="hs-operator">.</span> <span class="hs-identifier">Monad</span> <span class="hs-operator">.</span> <span class="hs-identifier">ST</span> <span></span> <a name="line-10"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Function</span> <span></span> <a name="line-11"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Maybe</span> <span></span> <a name="line-12"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">STRef</span> <span></span> <a name="line-13"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-keyword">qualified</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Vector</span> <span></span> <span class="hs-keyword">as</span> <span></span> <span class="hs-identifier">V</span> <span></span> <a name="line-14"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Prelude</span> <span></span> <span class="hs-keyword">hiding</span> <span></span> <span class="hs-special">(</span> <span class="hs-identifier hs-type">Num</span> <span></span> <span class="hs-special">(</span> <span class="hs-glyph">..</span> <span class="hs-special">)</span> <span class="hs-special">,</span> <span></span> <span class="hs-identifier hs-var">recip</span> <span class="hs-special">,</span> <span></span> <span class="hs-special">(</span> <span class="hs-operator hs-var">^</span> <span class="hs-special">)</span> <span class="hs-special">)</span> <span></span> <a name="line-15"></a><span></span> <a name="line-16"></a><span class="hs-keyword">data</span> <span></span> <a name="FGLMEnv"><a href="Algebra.Algorithms.FGLM.html#FGLMEnv"><span class="hs-identifier">FGLMEnv</span> </a></a><span></span> <a name="local-1628307852"><a href="#local-1628307852"><span class="hs-identifier">s</span> </a></a><span></span> <a name="local-1628307853"><a href="#local-1628307853"><span class="hs-identifier">r</span> </a></a><span></span> <a name="local-1628307854"><a href="#local-1628307854"><span class="hs-identifier">ord</span> </a></a><span></span> <a name="local-1628307855"><a href="#local-1628307855"><span class="hs-identifier">n</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a name="FGLMEnv"><a href="Algebra.Algorithms.FGLM.html#FGLMEnv"><span class="hs-identifier">FGLMEnv</span> </a></a><span></span> <span class="hs-special">{</span> <span></span> <a name="_lMap"><a href="Algebra.Algorithms.FGLM.html#_lMap"><span class="hs-identifier">_lMap</span> </a></a><span></span> <span class="hs-glyph">::</span> <span></span> <a href="Algebra.Ring.Polynomial.html#OrderedPolynomial"><span class="hs-identifier hs-type">OrderedPolynomial</span> </a><span></span> <a href="#local-1628307853"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="#local-1628307854"><span class="hs-identifier hs-type">ord</span> </a><span></span> <a href="#local-1628307855"><span class="hs-identifier hs-type">n</span> </a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <span class="hs-identifier hs-type">V</span> <span class="hs-operator hs-type">.</span> <span class="hs-identifier hs-type">Vector</span> <span></span> <a href="#local-1628307853"><span class="hs-identifier hs-type">r</span> </a><span></span> <a name="line-17"></a><span></span> <span class="hs-special">,</span> <span></span> <a name="_gLex"><a href="Algebra.Algorithms.FGLM.html#_gLex"><span class="hs-identifier">_gLex</span> </a></a><span></span> <span class="hs-glyph">::</span> <span></span> <span class="hs-identifier hs-type">STRef</span> <span></span> <a href="#local-1628307852"><span class="hs-identifier hs-type">s</span> </a><span></span> <span class="hs-special">[</span> <a href="Algebra.Ring.Polynomial.html#OrderedPolynomial"><span class="hs-identifier hs-type">OrderedPolynomial</span> </a><span></span> <a href="#local-1628307853"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Algebra.Ring.Polynomial.Monomial.html#Lex"><span class="hs-identifier hs-type">Lex</span> </a><span></span> <a href="#local-1628307855"><span class="hs-identifier hs-type">n</span> </a><span class="hs-special">]</span> <span></span> <a name="line-18"></a><span></span> <span class="hs-special">,</span> <span></span> <a name="_bLex"><a href="Algebra.Algorithms.FGLM.html#_bLex"><span class="hs-identifier">_bLex</span> </a></a><span></span> <span class="hs-glyph">::</span> <span></span> <span class="hs-identifier hs-type">STRef</span> <span></span> <a href="#local-1628307852"><span class="hs-identifier hs-type">s</span> </a><span></span> <span class="hs-special">[</span> <a href="Algebra.Ring.Polynomial.html#OrderedPolynomial"><span class="hs-identifier hs-type">OrderedPolynomial</span> </a><span></span> <a href="#local-1628307853"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="#local-1628307854"><span class="hs-identifier hs-type">ord</span> </a><span></span> <a href="#local-1628307855"><span class="hs-identifier hs-type">n</span> </a><span class="hs-special">]</span> <span></span> <a name="line-19"></a><span></span> <span class="hs-special">,</span> <span></span> <a name="_proced"><a href="Algebra.Algorithms.FGLM.html#_proced"><span class="hs-identifier">_proced</span> </a></a><span></span> <span class="hs-glyph">::</span> <span></span> <span class="hs-identifier hs-type">STRef</span> <span></span> <a href="#local-1628307852"><span class="hs-identifier hs-type">s</span> </a><span></span> <span class="hs-special">(</span> <span class="hs-identifier hs-type">Maybe</span> <span></span> <span class="hs-special">(</span> <a href="Algebra.Ring.Polynomial.html#OrderedPolynomial"><span class="hs-identifier hs-type">OrderedPolynomial</span> </a><span></span> <a href="#local-1628307853"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Algebra.Ring.Polynomial.Monomial.html#Lex"><span class="hs-identifier hs-type">Lex</span> </a><span></span> <a href="#local-1628307855"><span class="hs-identifier hs-type">n</span> </a><span class="hs-special">)</span> <span class="hs-special">)</span> <span></span> <a name="line-20"></a><span></span> <span class="hs-special">,</span> <span></span> <a name="_monomial"><a href="Algebra.Algorithms.FGLM.html#_monomial"><span class="hs-identifier">_monomial</span> </a></a><span></span> <span class="hs-glyph">::</span> <span></span> <span class="hs-identifier hs-type">STRef</span> <span></span> <a href="#local-1628307852"><span class="hs-identifier hs-type">s</span> </a><span></span> <span class="hs-special">(</span> <a href="Algebra.Ring.Polynomial.Monomial.html#OrderedMonomial"><span class="hs-identifier hs-type">OrderedMonomial</span> </a><span></span> <a href="Algebra.Ring.Polynomial.Monomial.html#Lex"><span class="hs-identifier hs-type">Lex</span> </a><span></span> <a href="#local-1628307855"><span class="hs-identifier hs-type">n</span> </a><span class="hs-special">)</span> <span></span> <a name="line-21"></a><span></span> <span class="hs-special">}</span> <span></span> <a name="line-22"></a><span></span> <a name="line-23"></a><span class="hs-identifier hs-var">makeLenses</span> <span></span> <span class="hs-char">&#39;&#39;FGLMEnv

type Machine s r ord n = ReaderT (FGLMEnv s r ord n) (ST s)

look :: Getting (STRef s b) (FGLMEnv s r ord n) (STRef s b) -&gt; Machine s r ord n b
look = lift . readSTRef &lt;=&lt; view

(.==) :: (MonadTrans t, MonadReader s (t (ST s1))) =&gt; Getting (STRef s1 a) s (STRef s1 a) -&gt; a -&gt; t (ST s1) ()
v .== a = do
  ref &lt;- view v
  lift $ writeSTRef ref a

(%==) :: (MonadTrans t, MonadReader s (t (ST s1))) =&gt; Getting (STRef s1 a) s (STRef s1 a) -&gt; (a -&gt; a) -&gt; t (ST s1) ()
v %== f = do
  ref &lt;- view v
  lift $ modifySTRef&#39; ref f

infix 4 .==, %==

image :: (MonadReader (FGLMEnv s r ord n) f) =&gt; OrderedPolynomial r ord n -&gt; f (V.Vector r)
image a = views lMap ($ a)
</span> </pre></body></html></DOCTYPE>