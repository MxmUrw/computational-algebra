<DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;=""><html xmlns="http://www.w3.org/1999/xhtml"><head><link href="style.css" type="text/css" rel="stylesheet"></link><script src="highlight.js" type="text/javascript"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances
           , MultiParamTypeClasses
           , TypeFamilies
           , UndecidableInstances
           , DeriveDataTypeable
           , TypeOperators #-}</span> <span></span> <a name="line-7"></a><span class="hs-keyword">module</span> <span></span> <span class="hs-identifier">Numeric</span> <span class="hs-operator">.</span> <span class="hs-identifier">Coalgebra</span> <span class="hs-operator">.</span> <span class="hs-identifier">Quaternion</span> <span></span> <a name="line-8"></a><span></span> <span class="hs-special">(</span> <span></span> <a href="Numeric.Algebra.Distinguished.Class.html#Distinguished"><span class="hs-identifier hs-type">Distinguished</span> </a><span class="hs-special">(</span> <span class="hs-glyph">..</span> <span class="hs-special">)</span> <span></span> <a name="line-9"></a><span></span> <span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Complex.Class.html#Complicated"><span class="hs-identifier hs-type">Complicated</span> </a><span class="hs-special">(</span> <span class="hs-glyph">..</span> <span class="hs-special">)</span> <span></span> <a name="line-10"></a><span></span> <span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Quaternion.Class.html#Hamiltonian"><span class="hs-identifier hs-type">Hamiltonian</span> </a><span class="hs-special">(</span> <span class="hs-glyph">..</span> <span class="hs-special">)</span> <span></span> <a name="line-11"></a><span></span> <span class="hs-special">,</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span class="hs-special">(</span> <span class="hs-glyph">..</span> <span class="hs-special">)</span> <span></span> <a name="line-12"></a><span></span> <span class="hs-special">,</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span class="hs-special">(</span> <span class="hs-glyph">..</span> <span class="hs-special">)</span> <span></span> <a name="line-13"></a><span></span> <span class="hs-special">,</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#complicate%27"><span class="hs-identifier hs-var">complicate&#39;</span> </a><span></span> <a name="line-14"></a><span></span> <span class="hs-special">,</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#vectorPart%27"><span class="hs-identifier hs-var">vectorPart&#39;</span> </a><span></span> <a name="line-15"></a><span></span> <span class="hs-special">,</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#scalarPart%27"><span class="hs-identifier hs-var">scalarPart&#39;</span> </a><span></span> <a name="line-16"></a><span></span> <span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-17"></a><span></span> <a name="line-18"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Control</span> <span class="hs-operator">.</span> <span class="hs-identifier">Applicative</span> <span></span> <a name="line-19"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Control</span> <span class="hs-operator">.</span> <span class="hs-identifier">Monad</span> <span class="hs-operator">.</span> <span class="hs-identifier">Reader</span> <span class="hs-operator">.</span> <span class="hs-identifier">Class</span> <span></span> <a name="line-20"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Ix</span> <span></span> <span class="hs-keyword">hiding</span> <span></span> <span class="hs-special">(</span> <span class="hs-identifier hs-var">index</span> <span class="hs-special">)</span> <span></span> <a name="line-21"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Data</span> <span></span> <a name="line-22"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Distributive</span> <span></span> <a name="line-23"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Functor</span> <span class="hs-operator">.</span> <span class="hs-identifier">Bind</span> <span></span> <a name="line-24"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Functor</span> <span class="hs-operator">.</span> <span class="hs-identifier">Rep</span> <span></span> <a name="line-25"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Foldable</span> <span></span> <a name="line-26"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Traversable</span> <span></span> <a name="line-27"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Semigroup</span> <span class="hs-operator">.</span> <span class="hs-identifier">Traversable</span> <span></span> <a name="line-28"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Semigroup</span> <span class="hs-operator">.</span> <span class="hs-identifier">Foldable</span> <span></span> <a name="line-29"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Data</span> <span class="hs-operator">.</span> <span class="hs-identifier">Semigroup</span> <span></span> <a name="line-30"></a><span class="hs-keyword">import</span> <span></span> <a href="Numeric.Algebra.html"><span class="hs-identifier">Numeric</span> <span class="hs-operator">.</span> <span class="hs-identifier">Algebra</span> </a><span></span> <a name="line-31"></a><span class="hs-keyword">import</span> <span></span> <a href="Numeric.Algebra.Distinguished.Class.html"><span class="hs-identifier">Numeric</span> <span class="hs-operator">.</span> <span class="hs-identifier">Algebra</span> <span class="hs-operator">.</span> <span class="hs-identifier">Distinguished</span> <span class="hs-operator">.</span> <span class="hs-identifier">Class</span> </a><span></span> <a name="line-32"></a><span class="hs-keyword">import</span> <span></span> <a href="Numeric.Algebra.Complex.Class.html"><span class="hs-identifier">Numeric</span> <span class="hs-operator">.</span> <span class="hs-identifier">Algebra</span> <span class="hs-operator">.</span> <span class="hs-identifier">Complex</span> <span class="hs-operator">.</span> <span class="hs-identifier">Class</span> </a><span></span> <a name="line-33"></a><span class="hs-keyword">import</span> <span></span> <a href="Numeric.Algebra.Quaternion.Class.html"><span class="hs-identifier">Numeric</span> <span class="hs-operator">.</span> <span class="hs-identifier">Algebra</span> <span class="hs-operator">.</span> <span class="hs-identifier">Quaternion</span> <span class="hs-operator">.</span> <span class="hs-identifier">Class</span> </a><span></span> <a name="line-34"></a><span class="hs-keyword">import</span> <span></span> <span class="hs-identifier">Prelude</span> <span></span> <span class="hs-keyword">hiding</span> <span></span> <span class="hs-special">(</span> <span class="hs-special">(</span> <span class="hs-glyph">-</span> <span class="hs-special">)</span> <span class="hs-special">,</span> <span class="hs-special">(</span> <span class="hs-operator hs-var">+</span> <span class="hs-special">)</span> <span class="hs-special">,</span> <span class="hs-special">(</span> <span class="hs-operator hs-var">*</span> <span class="hs-special">)</span> <span class="hs-special">,</span> <span class="hs-identifier hs-var">negate</span> <span class="hs-special">,</span> <span class="hs-identifier hs-var">subtract</span> <span class="hs-special">,</span> <span></span> <span class="hs-identifier hs-var">fromInteger</span> <span class="hs-special">)</span> <span></span> <a name="line-35"></a><span></span> <a name="line-36"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Algebra.Distinguished.Class.html#Distinguished"><span class="hs-identifier hs-type">Distinguished</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-37"></a><span></span> <a name="local-1912704349"><a href="Numeric.Algebra.Distinguished.Class.html#e"><span class="hs-identifier">e</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a name="line-38"></a><span></span> <a name="line-39"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Algebra.Complex.Class.html#Complicated"><span class="hs-identifier hs-type">Complicated</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-40"></a><span></span> <a name="local-1912704396"><a href="Numeric.Algebra.Complex.Class.html#i"><span class="hs-identifier">i</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <a name="line-41"></a><span></span> <a name="line-42"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Algebra.Quaternion.Class.html#Hamiltonian"><span class="hs-identifier hs-type">Hamiltonian</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-43"></a><span></span> <a name="local-1912704449"><a href="Numeric.Algebra.Quaternion.Class.html#j"><span class="hs-identifier">j</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <a name="line-44"></a><span></span> <a name="local-1912704450"><a href="Numeric.Algebra.Quaternion.Class.html#k"><span class="hs-identifier">k</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <a name="line-45"></a><span></span> <a name="line-46"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Rig.Class.html#Rig"><span class="hs-identifier hs-type">Rig</span> </a><span></span> <a href="#local-1627544440"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Distinguished.Class.html#Distinguished"><span class="hs-identifier hs-type">Distinguished</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544440"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-47"></a><span></span> <a name="local-1912704349"><a href="Numeric.Algebra.Distinguished.Class.html#e"><span class="hs-identifier">e</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier hs-var">one</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a name="line-48"></a><span></span> <a name="line-49"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Rig.Class.html#Rig"><span class="hs-identifier hs-type">Rig</span> </a><span></span> <a href="#local-1627544439"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Complex.Class.html#Complicated"><span class="hs-identifier hs-type">Complicated</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544439"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-50"></a><span></span> <a name="local-1912704396"><a href="Numeric.Algebra.Complex.Class.html#i"><span class="hs-identifier">i</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier hs-var">one</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a name="line-51"></a><span></span> <a name="line-52"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Rig.Class.html#Rig"><span class="hs-identifier hs-type">Rig</span> </a><span></span> <a href="#local-1627544438"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Quaternion.Class.html#Hamiltonian"><span class="hs-identifier hs-type">Hamiltonian</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544438"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-53"></a><span></span> <a name="local-1912704449"><a href="Numeric.Algebra.Quaternion.Class.html#j"><span class="hs-identifier">j</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier hs-var">one</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a name="line-54"></a><span></span> <a name="local-1912704450"><a href="Numeric.Algebra.Quaternion.Class.html#k"><span class="hs-identifier">k</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier hs-var">one</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier hs-var">one</span> </a><span></span> <a name="line-55"></a><span></span> <a name="line-56"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Rig.Class.html#Rig"><span class="hs-identifier hs-type">Rig</span> </a><span></span> <a href="#local-1627544437"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Distinguished.Class.html#Distinguished"><span class="hs-identifier hs-type">Distinguished</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <a href="#local-1627544437"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-57"></a><span></span> <a name="local-1912704349"><a href="Numeric.Algebra.Distinguished.Class.html#e"><span class="hs-identifier">e</span> </a></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier hs-var">one</span> </a><span></span> <a name="line-58"></a><span></span> <span class="hs-identifier">e</span> <span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a name="line-59"></a><span></span> <a name="line-60"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Rig.Class.html#Rig"><span class="hs-identifier hs-type">Rig</span> </a><span></span> <a href="#local-1627544436"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Complex.Class.html#Complicated"><span class="hs-identifier hs-type">Complicated</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <a href="#local-1627544436"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-61"></a><span></span> <a name="local-1912704396"><a href="Numeric.Algebra.Complex.Class.html#i"><span class="hs-identifier">i</span> </a></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier hs-var">one</span> </a><span></span> <a name="line-62"></a><span></span> <span class="hs-identifier">i</span> <span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a name="line-63"></a><span></span> <a name="line-64"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Rig.Class.html#Rig"><span class="hs-identifier hs-type">Rig</span> </a><span></span> <a href="#local-1627544435"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Quaternion.Class.html#Hamiltonian"><span class="hs-identifier hs-type">Hamiltonian</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <a href="#local-1627544435"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-65"></a><span></span> <a name="local-1912704449"><a href="Numeric.Algebra.Quaternion.Class.html#j"><span class="hs-identifier">j</span> </a></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier hs-var">one</span> </a><span></span> <a name="line-66"></a><span></span> <span class="hs-identifier">j</span> <span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a name="line-67"></a><span></span> <a name="line-68"></a><span></span> <a name="local-1912704450"><a href="Numeric.Algebra.Quaternion.Class.html#k"><span class="hs-identifier">k</span> </a></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier hs-var">one</span> </a><span></span> <a name="line-69"></a><span></span> <span class="hs-identifier">k</span> <span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a name="line-70"></a><span></span> <a name="line-71"></a><span class="hs-comment">-- quaternion basis</span> <span></span> <a name="line-72"></a><span class="hs-keyword">data</span> <span></span> <a name="QuaternionBasis%27"><a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier">QuaternionBasis&#39;</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a name="E%27"><a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier">E&#39;</span> </a></a><span></span> <span class="hs-glyph">|</span> <span></span> <a name="I%27"><a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier">I&#39;</span> </a></a><span></span> <span class="hs-glyph">|</span> <span></span> <a name="J%27"><a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier">J&#39;</span> </a></a><span></span> <span class="hs-glyph">|</span> <span></span> <a name="K%27"><a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier">K&#39;</span> </a></a><span></span> <span class="hs-keyword">deriving</span> <span></span> <span class="hs-special">(</span> <span class="hs-identifier hs-type">Eq</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Ord</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Enum</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Read</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Show</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Bounded</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Ix</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Data</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Typeable</span> <span class="hs-special">)</span> <span></span> <a name="line-73"></a><span></span> <a name="line-74"></a><span class="hs-keyword">data</span> <span></span> <a name="Quaternion%27"><a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier">Quaternion&#39;</span> </a></a><span></span> <a name="local-1627544318"><a href="#local-1627544318"><span class="hs-identifier">a</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a name="Quaternion%27"><a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier">Quaternion&#39;</span> </a></a><span></span> <a href="#local-1627544318"><span class="hs-identifier hs-type">a</span> </a><span></span> <a href="#local-1627544318"><span class="hs-identifier hs-type">a</span> </a><span></span> <a href="#local-1627544318"><span class="hs-identifier hs-type">a</span> </a><span></span> <a href="#local-1627544318"><span class="hs-identifier hs-type">a</span> </a><span></span> <span class="hs-keyword">deriving</span> <span></span> <span class="hs-special">(</span> <span class="hs-identifier hs-type">Eq</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Show</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Read</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Data</span> <span class="hs-special">,</span> <span class="hs-identifier hs-type">Typeable</span> <span class="hs-special">)</span> <span></span> <a name="line-75"></a><span></span> <a name="line-76"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Representable</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-77"></a><span></span> <span class="hs-keyword">type</span> <span></span> <span class="hs-identifier">Rep</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <a name="line-78"></a><span></span> <a name="local-1912602876"><span class="hs-identifier">tabulate</span> </a><span></span> <a name="local-1627544430"><a href="#local-1627544430"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-special">(</span> <a href="#local-1627544430"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544430"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544430"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544430"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span class="hs-special">)</span> <span></span> <a name="line-79"></a><span></span> <a name="local-1912602875"><span class="hs-identifier">index</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544431"><a href="#local-1627544431"><span class="hs-identifier">a</span> </a></a><span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-identifier">_</span> <span class="hs-special">)</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544431"><span class="hs-identifier hs-var">a</span> </a><span></span> <a name="line-80"></a><span></span> <span class="hs-identifier">index</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-identifier">_</span> <span></span> <a name="local-1627544432"><a href="#local-1627544432"><span class="hs-identifier">b</span> </a></a><span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-identifier">_</span> <span class="hs-special">)</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544432"><span class="hs-identifier hs-var">b</span> </a><span></span> <a name="line-81"></a><span></span> <span class="hs-identifier">index</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-identifier">_</span> <span></span> <a name="local-1627544433"><a href="#local-1627544433"><span class="hs-identifier">c</span> </a></a><span></span> <span class="hs-identifier">_</span> <span class="hs-special">)</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544433"><span class="hs-identifier hs-var">c</span> </a><span></span> <a name="line-82"></a><span></span> <span class="hs-identifier">index</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-identifier">_</span> <span></span> <span class="hs-identifier">_</span> <span></span> <a name="local-1627544434"><a href="#local-1627544434"><span class="hs-identifier">d</span> </a></a><span class="hs-special">)</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544434"><span class="hs-identifier hs-var">d</span> </a><span></span> <a name="line-83"></a><span></span> <a name="line-84"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Distributive</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-85"></a><span></span> <a name="local-1912611997"><span class="hs-identifier">distribute</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">distributeRep</span> <span></span> <a name="line-86"></a><span></span> <a name="line-87"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Functor</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-88"></a><span></span> <a name="local-805306541"><span class="hs-identifier">fmap</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">fmapRep</span> <span></span> <a name="line-89"></a><span></span> <a name="line-90"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Apply</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-91"></a><span></span> <span class="hs-special">(</span> <a name="local-1912614868"><span class="hs-operator">&lt;.&gt;</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">apRep</span> <span></span> <a name="line-92"></a><span></span> <a name="line-93"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Applicative</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-94"></a><span></span> <a name="local-805307120"><span class="hs-identifier">pure</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">pureRep</span> <span></span> <a name="line-95"></a><span></span> <span class="hs-special">(</span> <a name="local-805307119"><span class="hs-operator">&lt;*&gt;</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">apRep</span> <span></span> <a name="line-96"></a><span></span> <a name="line-97"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Bind</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-98"></a><span></span> <span class="hs-special">(</span> <a name="local-1912614877"><span class="hs-operator">&gt;&gt;-</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">bindRep</span> <span></span> <a name="line-99"></a><span></span> <a name="line-100"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Monad</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-101"></a><span></span> <a name="local-805306542"><span class="hs-identifier">return</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">pureRep</span> <span></span> <a name="line-102"></a><span></span> <span class="hs-special">(</span> <a name="local-805306539"><span class="hs-operator">&gt;&gt;=</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">bindRep</span> <span></span> <a name="line-103"></a><span></span> <a name="line-104"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">MonadReader</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-105"></a><span></span> <a name="local-1912602887"><span class="hs-identifier">ask</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">askRep</span> <span></span> <a name="line-106"></a><span></span> <a name="local-1912602888"><span class="hs-identifier">local</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">localRep</span> <span></span> <a name="line-107"></a><span></span> <a name="line-108"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Foldable</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-109"></a><span></span> <a name="local-1912607945"><span class="hs-identifier">foldMap</span> </a><span></span> <a name="local-1627544425"><a href="#local-1627544425"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544426"><a href="#local-1627544426"><span class="hs-identifier">a</span> </a></a><span></span> <a name="local-1627544427"><a href="#local-1627544427"><span class="hs-identifier">b</span> </a></a><span></span> <a name="local-1627544428"><a href="#local-1627544428"><span class="hs-identifier">c</span> </a></a><span></span> <a name="local-1627544429"><a href="#local-1627544429"><span class="hs-identifier">d</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a name="line-110"></a><span></span> <a href="#local-1627544425"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544426"><span class="hs-identifier hs-var">a</span> </a><span></span> <span class="hs-special">`</span> <span class="hs-identifier hs-var">mappend</span> <span class="hs-special">`</span> <span></span> <a href="#local-1627544425"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544427"><span class="hs-identifier hs-var">b</span> </a><span></span> <span class="hs-special">`</span> <span class="hs-identifier hs-var">mappend</span> <span class="hs-special">`</span> <span></span> <a href="#local-1627544425"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544428"><span class="hs-identifier hs-var">c</span> </a><span></span> <span class="hs-special">`</span> <span class="hs-identifier hs-var">mappend</span> <span class="hs-special">`</span> <span></span> <a href="#local-1627544425"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544429"><span class="hs-identifier hs-var">d</span> </a><span></span> <a name="line-111"></a><span></span> <a name="line-112"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Traversable</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-113"></a><span></span> <a name="local-1912606368"><span class="hs-identifier">traverse</span> </a><span></span> <a name="local-1627544420"><a href="#local-1627544420"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544421"><a href="#local-1627544421"><span class="hs-identifier">a</span> </a></a><span></span> <a name="local-1627544422"><a href="#local-1627544422"><span class="hs-identifier">b</span> </a></a><span></span> <a name="local-1627544423"><a href="#local-1627544423"><span class="hs-identifier">c</span> </a></a><span></span> <a name="local-1627544424"><a href="#local-1627544424"><span class="hs-identifier">d</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a name="line-114"></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-operator hs-var">&lt;$&gt;</span> <span></span> <a href="#local-1627544420"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544421"><span class="hs-identifier hs-var">a</span> </a><span></span> <span class="hs-operator hs-var">&lt;*&gt;</span> <span></span> <a href="#local-1627544420"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544422"><span class="hs-identifier hs-var">b</span> </a><span></span> <span class="hs-operator hs-var">&lt;*&gt;</span> <span></span> <a href="#local-1627544420"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544423"><span class="hs-identifier hs-var">c</span> </a><span></span> <span class="hs-operator hs-var">&lt;*&gt;</span> <span></span> <a href="#local-1627544420"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544424"><span class="hs-identifier hs-var">d</span> </a><span></span> <a name="line-115"></a><span></span> <a name="line-116"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Foldable1</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-117"></a><span></span> <a name="local-1912614928"><span class="hs-identifier">foldMap1</span> </a><span></span> <a name="local-1627544415"><a href="#local-1627544415"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544416"><a href="#local-1627544416"><span class="hs-identifier">a</span> </a></a><span></span> <a name="local-1627544417"><a href="#local-1627544417"><span class="hs-identifier">b</span> </a></a><span></span> <a name="local-1627544418"><a href="#local-1627544418"><span class="hs-identifier">c</span> </a></a><span></span> <a name="local-1627544419"><a href="#local-1627544419"><span class="hs-identifier">d</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a name="line-118"></a><span></span> <a href="#local-1627544415"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544416"><span class="hs-identifier hs-var">a</span> </a><span></span> <span class="hs-operator hs-var">&lt;&gt;</span> <span></span> <a href="#local-1627544415"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544417"><span class="hs-identifier hs-var">b</span> </a><span></span> <span class="hs-operator hs-var">&lt;&gt;</span> <span></span> <a href="#local-1627544415"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544418"><span class="hs-identifier hs-var">c</span> </a><span></span> <span class="hs-operator hs-var">&lt;&gt;</span> <span></span> <a href="#local-1627544415"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544419"><span class="hs-identifier hs-var">d</span> </a><span></span> <a name="line-119"></a><span></span> <a name="line-120"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-identifier hs-type">Traversable1</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-121"></a><span></span> <a name="local-1912614621"><span class="hs-identifier">traverse1</span> </a><span></span> <a name="local-1627544410"><a href="#local-1627544410"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544411"><a href="#local-1627544411"><span class="hs-identifier">a</span> </a></a><span></span> <a name="local-1627544412"><a href="#local-1627544412"><span class="hs-identifier">b</span> </a></a><span></span> <a name="local-1627544413"><a href="#local-1627544413"><span class="hs-identifier">c</span> </a></a><span></span> <a name="local-1627544414"><a href="#local-1627544414"><span class="hs-identifier">d</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a name="line-122"></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-operator hs-var">&lt;$&gt;</span> <span></span> <a href="#local-1627544410"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544411"><span class="hs-identifier hs-var">a</span> </a><span></span> <span class="hs-operator hs-var">&lt;.&gt;</span> <span></span> <a href="#local-1627544410"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544412"><span class="hs-identifier hs-var">b</span> </a><span></span> <span class="hs-operator hs-var">&lt;.&gt;</span> <span></span> <a href="#local-1627544410"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544413"><span class="hs-identifier hs-var">c</span> </a><span></span> <span class="hs-operator hs-var">&lt;.&gt;</span> <span></span> <a href="#local-1627544410"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544414"><span class="hs-identifier hs-var">d</span> </a><span></span> <a name="line-123"></a><span></span> <a name="line-124"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Additive.Class.html#Additive"><span class="hs-identifier hs-type">Additive</span> </a><span></span> <a href="#local-1627544409"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Additive.Class.html#Additive"><span class="hs-identifier hs-type">Additive</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544409"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-125"></a><span></span> <span class="hs-special">(</span> <a name="local-1912632347"><a href="Numeric.Additive.Class.html#%2B"><span class="hs-operator">+</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#addRep"><span class="hs-identifier hs-var">addRep</span> </a><span></span> <a name="line-126"></a><span></span> <a name="local-1912632348"><a href="Numeric.Additive.Class.html#sinnum1p"><span class="hs-identifier">sinnum1p</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#sinnum1pRep"><span class="hs-identifier hs-var">sinnum1pRep</span> </a><span></span> <a name="line-127"></a><span></span> <a name="line-128"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Algebra.Class.html#LeftModule"><span class="hs-identifier hs-type">LeftModule</span> </a><span></span> <a href="#local-1627544402"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="#local-1627544403"><span class="hs-identifier hs-type">s</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Class.html#LeftModule"><span class="hs-identifier hs-type">LeftModule</span> </a><span></span> <a href="#local-1627544402"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544403"><span class="hs-identifier hs-type">s</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-129"></a><span></span> <a name="local-1627544404"><a href="#local-1627544404"><span class="hs-identifier">r</span> </a></a><span></span> <a name="local-1912640754"><a href="Numeric.Algebra.Class.html#.%2A"><span class="hs-operator">.*</span> </a></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544405"><a href="#local-1627544405"><span class="hs-identifier">a</span> </a></a><span></span> <a name="local-1627544406"><a href="#local-1627544406"><span class="hs-identifier">b</span> </a></a><span></span> <a name="local-1627544407"><a href="#local-1627544407"><span class="hs-identifier">c</span> </a></a><span></span> <a name="local-1627544408"><a href="#local-1627544408"><span class="hs-identifier">d</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a name="line-130"></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-special">(</span> <a href="#local-1627544404"><span class="hs-identifier hs-var">r</span> </a><span></span> <a href="Numeric.Algebra.Class.html#.%2A"><span class="hs-operator hs-var">.*</span> </a><span></span> <a href="#local-1627544405"><span class="hs-identifier hs-var">a</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544404"><span class="hs-identifier hs-var">r</span> </a><span></span> <a href="Numeric.Algebra.Class.html#.%2A"><span class="hs-operator hs-var">.*</span> </a><span></span> <a href="#local-1627544406"><span class="hs-identifier hs-var">b</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544404"><span class="hs-identifier hs-var">r</span> </a><span></span> <a href="Numeric.Algebra.Class.html#.%2A"><span class="hs-operator hs-var">.*</span> </a><span></span> <a href="#local-1627544407"><span class="hs-identifier hs-var">c</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544404"><span class="hs-identifier hs-var">r</span> </a><span></span> <a href="Numeric.Algebra.Class.html#.%2A"><span class="hs-operator hs-var">.*</span> </a><span></span> <a href="#local-1627544408"><span class="hs-identifier hs-var">d</span> </a><span class="hs-special">)</span> <span></span> <a name="line-131"></a><span></span> <a name="line-132"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Algebra.Class.html#RightModule"><span class="hs-identifier hs-type">RightModule</span> </a><span></span> <a href="#local-1627544395"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="#local-1627544396"><span class="hs-identifier hs-type">s</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Class.html#RightModule"><span class="hs-identifier hs-type">RightModule</span> </a><span></span> <a href="#local-1627544395"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544396"><span class="hs-identifier hs-type">s</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-133"></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544397"><a href="#local-1627544397"><span class="hs-identifier">a</span> </a></a><span></span> <a name="local-1627544398"><a href="#local-1627544398"><span class="hs-identifier">b</span> </a></a><span></span> <a name="local-1627544399"><a href="#local-1627544399"><span class="hs-identifier">c</span> </a></a><span></span> <a name="local-1627544400"><a href="#local-1627544400"><span class="hs-identifier">d</span> </a></a><span></span> <a name="local-1912640752"><a href="Numeric.Algebra.Class.html#%2A."><span class="hs-operator">*.</span> </a></a><span></span> <a name="local-1627544401"><a href="#local-1627544401"><span class="hs-identifier">r</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a name="line-134"></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-special">(</span> <a href="#local-1627544397"><span class="hs-identifier hs-var">a</span> </a><span></span> <a href="Numeric.Algebra.Class.html#%2A."><span class="hs-operator hs-var">*.</span> </a><span></span> <a href="#local-1627544401"><span class="hs-identifier hs-var">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544398"><span class="hs-identifier hs-var">b</span> </a><span></span> <a href="Numeric.Algebra.Class.html#%2A."><span class="hs-operator hs-var">*.</span> </a><span></span> <a href="#local-1627544401"><span class="hs-identifier hs-var">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544399"><span class="hs-identifier hs-var">c</span> </a><span></span> <a href="Numeric.Algebra.Class.html#%2A."><span class="hs-operator hs-var">*.</span> </a><span></span> <a href="#local-1627544401"><span class="hs-identifier hs-var">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544400"><span class="hs-identifier hs-var">d</span> </a><span></span> <a href="Numeric.Algebra.Class.html#%2A."><span class="hs-operator hs-var">*.</span> </a><span></span> <a href="#local-1627544401"><span class="hs-identifier hs-var">r</span> </a><span class="hs-special">)</span> <span></span> <a name="line-135"></a><span></span> <a name="line-136"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Algebra.Class.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span> </a><span></span> <a href="#local-1627544394"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Class.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544394"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-137"></a><span></span> <a name="local-1912640747"><a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier">zero</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#zeroRep"><span class="hs-identifier hs-var">zeroRep</span> </a><span></span> <a name="line-138"></a><span></span> <a name="local-1912640748"><a href="Numeric.Algebra.Class.html#sinnum"><span class="hs-identifier">sinnum</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#sinnumRep"><span class="hs-identifier hs-var">sinnumRep</span> </a><span></span> <a name="line-139"></a><span></span> <a name="line-140"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Additive.Group.html#Group"><span class="hs-identifier hs-type">Group</span> </a><span></span> <a href="#local-1627544393"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Additive.Group.html#Group"><span class="hs-identifier hs-type">Group</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544393"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-141"></a><span></span> <span class="hs-special">(</span> <span class="hs-glyph">-</span> <span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#minusRep"><span class="hs-identifier hs-var">minusRep</span> </a><span></span> <a name="line-142"></a><span></span> <a name="local-1912650189"><a href="Numeric.Additive.Group.html#negate"><span class="hs-identifier">negate</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#negateRep"><span class="hs-identifier hs-var">negateRep</span> </a><span></span> <a name="line-143"></a><span></span> <a name="local-1912650190"><a href="Numeric.Additive.Group.html#subtract"><span class="hs-identifier">subtract</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#subtractRep"><span class="hs-identifier hs-var">subtractRep</span> </a><span></span> <a name="line-144"></a><span></span> <a name="local-1912650191"><a href="Numeric.Additive.Group.html#times"><span class="hs-identifier">times</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#timesRep"><span class="hs-identifier hs-var">timesRep</span> </a><span></span> <a name="line-145"></a><span></span> <a name="line-146"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Additive.Class.html#Abelian"><span class="hs-identifier hs-type">Abelian</span> </a><span></span> <a href="#local-1627544392"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Additive.Class.html#Abelian"><span class="hs-identifier hs-type">Abelian</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544392"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <a name="line-147"></a><span></span> <a name="line-148"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Additive.Class.html#Idempotent"><span class="hs-identifier hs-type">Idempotent</span> </a><span></span> <a href="#local-1627544391"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Additive.Class.html#Idempotent"><span class="hs-identifier hs-type">Idempotent</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544391"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <a name="line-149"></a><span></span> <a name="line-150"></a><span class="hs-keyword">instance</span> <span></span> <a href="Numeric.Additive.Class.html#Partitionable"><span class="hs-identifier hs-type">Partitionable</span> </a><span></span> <a href="#local-1627544377"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Additive.Class.html#Partitionable"><span class="hs-identifier hs-type">Partitionable</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544377"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-151"></a><span></span> <a name="local-1912632345"><a href="Numeric.Additive.Class.html#partitionWith"><span class="hs-identifier">partitionWith</span> </a></a><span></span> <a name="local-1627544378"><a href="#local-1627544378"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544379"><a href="#local-1627544379"><span class="hs-identifier">a</span> </a></a><span></span> <a name="local-1627544380"><a href="#local-1627544380"><span class="hs-identifier">b</span> </a></a><span></span> <a name="local-1627544381"><a href="#local-1627544381"><span class="hs-identifier">c</span> </a></a><span></span> <a name="local-1627544382"><a href="#local-1627544382"><span class="hs-identifier">d</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">id</span> <span></span> <span class="hs-operator hs-var">=&lt;&lt;</span> <span></span> <a name="line-152"></a><span></span> <a href="Numeric.Additive.Class.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span> </a><span></span> <span class="hs-special">(</span> <span class="hs-glyph">\</span> <a name="local-1627544383"><a href="#local-1627544383"><span class="hs-identifier">a1</span> </a></a><span></span> <a name="local-1627544384"><a href="#local-1627544384"><span class="hs-identifier">a2</span> </a></a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <span class="hs-identifier hs-var">id</span> <span></span> <span class="hs-operator hs-var">=&lt;&lt;</span> <span></span> <a name="line-153"></a><span></span> <a href="Numeric.Additive.Class.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span> </a><span></span> <span class="hs-special">(</span> <span class="hs-glyph">\</span> <a name="local-1627544385"><a href="#local-1627544385"><span class="hs-identifier">b1</span> </a></a><span></span> <a name="local-1627544386"><a href="#local-1627544386"><span class="hs-identifier">b2</span> </a></a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <span class="hs-identifier hs-var">id</span> <span></span> <span class="hs-operator hs-var">=&lt;&lt;</span> <span></span> <a name="line-154"></a><span></span> <a href="Numeric.Additive.Class.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span> </a><span></span> <span class="hs-special">(</span> <span class="hs-glyph">\</span> <a name="local-1627544387"><a href="#local-1627544387"><span class="hs-identifier">c1</span> </a></a><span></span> <a name="local-1627544388"><a href="#local-1627544388"><span class="hs-identifier">c2</span> </a></a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <a name="line-155"></a><span></span> <a href="Numeric.Additive.Class.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span> </a><span></span> <span class="hs-special">(</span> <span class="hs-glyph">\</span> <a name="local-1627544389"><a href="#local-1627544389"><span class="hs-identifier">d1</span> </a></a><span></span> <a name="local-1627544390"><a href="#local-1627544390"><span class="hs-identifier">d2</span> </a></a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <a href="#local-1627544378"><span class="hs-identifier hs-var">f</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544383"><span class="hs-identifier hs-var">a1</span> </a><span></span> <a href="#local-1627544385"><span class="hs-identifier hs-var">b1</span> </a><span></span> <a href="#local-1627544387"><span class="hs-identifier hs-var">c1</span> </a><span></span> <a href="#local-1627544389"><span class="hs-identifier hs-var">d1</span> </a><span class="hs-special">)</span> <span></span> <a name="line-156"></a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544384"><span class="hs-identifier hs-var">a2</span> </a><span></span> <a href="#local-1627544386"><span class="hs-identifier hs-var">b2</span> </a><span></span> <a href="#local-1627544388"><span class="hs-identifier hs-var">c2</span> </a><span></span> <a href="#local-1627544390"><span class="hs-identifier hs-var">d2</span> </a><span class="hs-special">)</span> <span></span> <a name="line-157"></a><span></span> <span class="hs-special">)</span> <span></span> <a href="#local-1627544382"><span class="hs-identifier hs-var">d</span> </a><span class="hs-special">)</span> <span></span> <a href="#local-1627544381"><span class="hs-identifier hs-var">c</span> </a><span class="hs-special">)</span> <span></span> <a href="#local-1627544380"><span class="hs-identifier hs-var">b</span> </a><span class="hs-special">)</span> <span></span> <a href="#local-1627544379"><span class="hs-identifier hs-var">a</span> </a><span></span> <a name="line-158"></a><span></span> <a name="line-159"></a><span class="hs-comment">-- | the trivial diagonal algebra</span> <span></span> <a name="line-160"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544370"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Class.html#Semiring"><span class="hs-identifier hs-type">Semiring</span> </a><span></span> <a href="#local-1627544370"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Class.html#Algebra"><span class="hs-identifier hs-type">Algebra</span> </a><span></span> <a href="#local-1627544370"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-161"></a><span></span> <a name="local-1912640758"><a href="Numeric.Algebra.Class.html#mult"><span class="hs-identifier">mult</span> </a></a><span></span> <a name="local-1627544371"><a href="#local-1627544371"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544376"><span class="hs-identifier hs-var">f&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-162"></a><span></span> <a name="local-1627544372"><a href="#local-1627544372"><span class="hs-identifier">fe</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544371"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a name="line-163"></a><span></span> <a name="local-1627544373"><a href="#local-1627544373"><span class="hs-identifier">fi</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544371"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <a name="line-164"></a><span></span> <a name="local-1627544374"><a href="#local-1627544374"><span class="hs-identifier">fj</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544371"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <a name="line-165"></a><span></span> <a name="local-1627544375"><a href="#local-1627544375"><span class="hs-identifier">fk</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544371"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <a name="line-166"></a><span></span> <a name="local-1627544376"><a href="#local-1627544376"><span class="hs-identifier">f&#39;</span> </a></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544372"><span class="hs-identifier hs-var">fe</span> </a><span></span> <a name="line-167"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544373"><span class="hs-identifier hs-var">fi</span> </a><span></span> <a name="line-168"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544374"><span class="hs-identifier hs-var">fj</span> </a><span></span> <a name="line-169"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544375"><span class="hs-identifier hs-var">fk</span> </a><span></span> <a name="line-170"></a><span></span> <a name="line-171"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544369"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Class.html#Semiring"><span class="hs-identifier hs-type">Semiring</span> </a><span></span> <a href="#local-1627544369"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Unital.html#UnitalAlgebra"><span class="hs-identifier hs-type">UnitalAlgebra</span> </a><span></span> <a href="#local-1627544369"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-172"></a><span></span> <a name="local-1912652692"><a href="Numeric.Algebra.Unital.html#unit"><span class="hs-identifier">unit</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">const</span> <span></span> <a name="line-173"></a><span></span> <a name="line-174"></a><span></span> <a name="line-175"></a><span class="hs-comment">-- | dual quaternion comultiplication</span> <span></span> <a name="line-176"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544358"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544358"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Class.html#Coalgebra"><span class="hs-identifier hs-type">Coalgebra</span> </a><span></span> <a href="#local-1627544358"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-177"></a><span></span> <a name="local-1912640756"><a href="Numeric.Algebra.Class.html#comult"><span class="hs-identifier">comult</span> </a></a><span></span> <a name="local-1627544359"><a href="#local-1627544359"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544368"><span class="hs-identifier hs-var">f&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-178"></a><span></span> <a name="local-1627544360"><a href="#local-1627544360"><span class="hs-identifier">fe</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544359"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a name="line-179"></a><span></span> <a name="local-1627544361"><a href="#local-1627544361"><span class="hs-identifier">fi</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544359"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <a name="line-180"></a><span></span> <a name="local-1627544362"><a href="#local-1627544362"><span class="hs-identifier">fj</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544359"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <a name="line-181"></a><span></span> <a name="local-1627544363"><a href="#local-1627544363"><span class="hs-identifier">fk</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544359"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <a name="line-182"></a><span></span> <a name="local-1627544364"><a href="#local-1627544364"><span class="hs-identifier">fe&#39;</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Additive.Group.html#negate"><span class="hs-identifier hs-var">negate</span> </a><span></span> <a href="#local-1627544360"><span class="hs-identifier hs-var">fe</span> </a><span></span> <a name="line-183"></a><span></span> <a name="local-1627544365"><a href="#local-1627544365"><span class="hs-identifier">fi&#39;</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Additive.Group.html#negate"><span class="hs-identifier hs-var">negate</span> </a><span></span> <a href="#local-1627544361"><span class="hs-identifier hs-var">fi</span> </a><span></span> <a name="line-184"></a><span></span> <a name="local-1627544366"><a href="#local-1627544366"><span class="hs-identifier">fj&#39;</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Additive.Group.html#negate"><span class="hs-identifier hs-var">negate</span> </a><span></span> <a href="#local-1627544362"><span class="hs-identifier hs-var">fj</span> </a><span></span> <a name="line-185"></a><span></span> <a name="local-1627544367"><a href="#local-1627544367"><span class="hs-identifier">fk&#39;</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Additive.Group.html#negate"><span class="hs-identifier hs-var">negate</span> </a><span></span> <a href="#local-1627544363"><span class="hs-identifier hs-var">fk</span> </a><span></span> <a name="line-186"></a><span></span> <a name="local-1627544368"><a href="#local-1627544368"><span class="hs-identifier">f&#39;</span> </a></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544360"><span class="hs-identifier hs-var">fe</span> </a><span></span> <a name="line-187"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544361"><span class="hs-identifier hs-var">fi</span> </a><span></span> <a name="line-188"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544362"><span class="hs-identifier hs-var">fj</span> </a><span></span> <a name="line-189"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544363"><span class="hs-identifier hs-var">fk</span> </a><span></span> <a name="line-190"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544361"><span class="hs-identifier hs-var">fi</span> </a><span></span> <a name="line-191"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544364"><span class="hs-identifier hs-var">fe&#39;</span> </a><span></span> <a name="line-192"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544363"><span class="hs-identifier hs-var">fk</span> </a><span></span> <a name="line-193"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544366"><span class="hs-identifier hs-var">fj&#39;</span> </a><span></span> <a name="line-194"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544362"><span class="hs-identifier hs-var">fj</span> </a><span></span> <a name="line-195"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544367"><span class="hs-identifier hs-var">fk&#39;</span> </a><span></span> <a name="line-196"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544364"><span class="hs-identifier hs-var">fe&#39;</span> </a><span></span> <a name="line-197"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544361"><span class="hs-identifier hs-var">fi</span> </a><span></span> <a name="line-198"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544363"><span class="hs-identifier hs-var">fk</span> </a><span></span> <a name="line-199"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544362"><span class="hs-identifier hs-var">fj</span> </a><span></span> <a name="line-200"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544365"><span class="hs-identifier hs-var">fi&#39;</span> </a><span></span> <a name="line-201"></a><span></span> <span class="hs-identifier">f&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544364"><span class="hs-identifier hs-var">fe&#39;</span> </a><span></span> <a name="line-202"></a><span></span> <a name="line-203"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544356"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544356"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Unital.html#CounitalCoalgebra"><span class="hs-identifier hs-type">CounitalCoalgebra</span> </a><span></span> <a href="#local-1627544356"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-204"></a><span></span> <a name="local-1912652690"><a href="Numeric.Algebra.Unital.html#counit"><span class="hs-identifier">counit</span> </a></a><span></span> <a name="local-1627544357"><a href="#local-1627544357"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544357"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a name="line-205"></a><span></span> <a name="line-206"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544355"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544355"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Unital.html#Bialgebra"><span class="hs-identifier hs-type">Bialgebra</span> </a><span></span> <a href="#local-1627544355"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <a name="line-207"></a><span></span> <a name="line-208"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544351"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Involutive.html#InvolutiveSemiring"><span class="hs-identifier hs-type">InvolutiveSemiring</span> </a><span></span> <a href="#local-1627544351"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544351"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Involutive.html#InvolutiveAlgebra"><span class="hs-identifier hs-type">InvolutiveAlgebra</span> </a><span></span> <a href="#local-1627544351"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-209"></a><span></span> <a name="local-1912672855"><a href="Numeric.Algebra.Involutive.html#inv"><span class="hs-identifier">inv</span> </a></a><span></span> <a name="local-1627544352"><a href="#local-1627544352"><span class="hs-identifier">f</span> </a></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="#local-1627544352"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a name="line-210"></a><span></span> <span class="hs-identifier">inv</span> <span></span> <a name="local-1627544353"><a href="#local-1627544353"><span class="hs-identifier">f</span> </a></a><span></span> <a name="local-1627544354"><a href="#local-1627544354"><span class="hs-identifier">b</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Additive.Group.html#negate"><span class="hs-identifier hs-var">negate</span> </a><span></span> <span class="hs-special">(</span> <a href="#local-1627544353"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="#local-1627544354"><span class="hs-identifier hs-var">b</span> </a><span class="hs-special">)</span> <span></span> <a name="line-211"></a><span></span> <a name="line-212"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544350"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Involutive.html#InvolutiveSemiring"><span class="hs-identifier hs-type">InvolutiveSemiring</span> </a><span></span> <a href="#local-1627544350"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544350"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Involutive.html#InvolutiveCoalgebra"><span class="hs-identifier hs-type">InvolutiveCoalgebra</span> </a><span></span> <a href="#local-1627544350"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-213"></a><span></span> <a name="local-1912672852"><a href="Numeric.Algebra.Involutive.html#coinv"><span class="hs-identifier">coinv</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Involutive.html#inv"><span class="hs-identifier hs-var">inv</span> </a><span></span> <a name="line-214"></a><span></span> <a name="line-215"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544349"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Involutive.html#InvolutiveSemiring"><span class="hs-identifier hs-type">InvolutiveSemiring</span> </a><span></span> <a href="#local-1627544349"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544349"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Hopf.html#HopfAlgebra"><span class="hs-identifier hs-type">HopfAlgebra</span> </a><span></span> <a href="#local-1627544349"><span class="hs-identifier hs-type">r</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-216"></a><span></span> <a name="local-1912657100"><a href="Numeric.Algebra.Hopf.html#antipode"><span class="hs-identifier">antipode</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Algebra.Involutive.html#inv"><span class="hs-identifier hs-var">inv</span> </a><span></span> <a name="line-217"></a><span></span> <a name="line-218"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544348"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Class.html#Semiring"><span class="hs-identifier hs-type">Semiring</span> </a><span></span> <a href="#local-1627544348"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Class.html#Multiplicative"><span class="hs-identifier hs-type">Multiplicative</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544348"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-219"></a><span></span> <span class="hs-special">(</span> <a name="local-1912640761"><a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator">*</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#mulRep"><span class="hs-identifier hs-var">mulRep</span> </a><span></span> <a name="line-220"></a><span></span> <a name="line-221"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544347"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Class.html#Semiring"><span class="hs-identifier hs-type">Semiring</span> </a><span></span> <a href="#local-1627544347"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Class.html#Semiring"><span class="hs-identifier hs-type">Semiring</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544347"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <a name="line-222"></a><span></span> <a name="line-223"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544346"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Ring.Class.html#Ring"><span class="hs-identifier hs-type">Ring</span> </a><span></span> <a href="#local-1627544346"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Unital.html#Unital"><span class="hs-identifier hs-type">Unital</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544346"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-224"></a><span></span> <a name="local-1912652694"><a href="Numeric.Algebra.Unital.html#one"><span class="hs-identifier">one</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Module.Representable.html#oneRep"><span class="hs-identifier hs-var">oneRep</span> </a><span></span> <a name="line-225"></a><span></span> <a name="line-226"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544344"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Ring.Class.html#Ring"><span class="hs-identifier hs-type">Ring</span> </a><span></span> <a href="#local-1627544344"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Rig.Class.html#Rig"><span class="hs-identifier hs-type">Rig</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544344"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-227"></a><span></span> <a name="local-1912659648"><a href="Numeric.Rig.Class.html#fromNatural"><span class="hs-identifier">fromNatural</span> </a></a><span></span> <a name="local-1627544345"><a href="#local-1627544345"><span class="hs-identifier">n</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Rig.Class.html#fromNatural"><span class="hs-identifier hs-var">fromNatural</span> </a><span></span> <a href="#local-1627544345"><span class="hs-identifier hs-var">n</span> </a><span class="hs-special">)</span> <span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a name="line-228"></a><span></span> <a name="line-229"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544342"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Ring.Class.html#Ring"><span class="hs-identifier hs-type">Ring</span> </a><span></span> <a href="#local-1627544342"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Ring.Class.html#Ring"><span class="hs-identifier hs-type">Ring</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544342"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-230"></a><span></span> <a name="local-1912662580"><a href="Numeric.Ring.Class.html#fromInteger"><span class="hs-identifier">fromInteger</span> </a></a><span></span> <a name="local-1627544343"><a href="#local-1627544343"><span class="hs-identifier">n</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Ring.Class.html#fromInteger"><span class="hs-identifier hs-var">fromInteger</span> </a><span></span> <a href="#local-1627544343"><span class="hs-identifier hs-var">n</span> </a><span class="hs-special">)</span> <span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span> </a><span></span> <a name="line-231"></a><span></span> <a name="line-232"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <span></span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544341"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544341"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Class.html#LeftModule"><span class="hs-identifier hs-type">LeftModule</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544341"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544341"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-233"></a><span></span> <span class="hs-special">(</span> <a name="local-1912640754"><a href="Numeric.Algebra.Class.html#.%2A"><span class="hs-operator">.*</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator hs-var">*</span> </a><span class="hs-special">)</span> <span></span> <a name="line-234"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544340"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544340"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Class.html#RightModule"><span class="hs-identifier hs-type">RightModule</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544340"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544340"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-235"></a><span></span> <span class="hs-special">(</span> <a name="local-1912640752"><a href="Numeric.Algebra.Class.html#%2A."><span class="hs-operator">*.</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator hs-var">*</span> </a><span class="hs-special">)</span> <span></span> <a name="line-236"></a><span></span> <a name="line-237"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544335"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544335"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Involutive.html#InvolutiveMultiplication"><span class="hs-identifier hs-type">InvolutiveMultiplication</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544335"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-238"></a><span></span> <span class="hs-comment">-- without trivial involution, multiplication fails associativity, and we&#39;d need to</span> <span></span> <a name="line-239"></a><span></span> <span class="hs-comment">-- support weaker multiplicative properties like Alternative and PowerAssociative</span> <span></span> <a name="line-240"></a><span></span> <a name="local-1912672859"><a href="Numeric.Algebra.Involutive.html#adjoint"><span class="hs-identifier">adjoint</span> </a></a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544336"><a href="#local-1627544336"><span class="hs-identifier">a</span> </a></a><span></span> <a name="local-1627544337"><a href="#local-1627544337"><span class="hs-identifier">b</span> </a></a><span></span> <a name="local-1627544338"><a href="#local-1627544338"><span class="hs-identifier">c</span> </a></a><span></span> <a name="local-1627544339"><a href="#local-1627544339"><span class="hs-identifier">d</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544336"><span class="hs-identifier hs-var">a</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Additive.Group.html#negate"><span class="hs-identifier hs-var">negate</span> </a><span></span> <a href="#local-1627544337"><span class="hs-identifier hs-var">b</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Additive.Group.html#negate"><span class="hs-identifier hs-var">negate</span> </a><span></span> <a href="#local-1627544338"><span class="hs-identifier hs-var">c</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Additive.Group.html#negate"><span class="hs-identifier hs-var">negate</span> </a><span></span> <a href="#local-1627544339"><span class="hs-identifier hs-var">d</span> </a><span class="hs-special">)</span> <span></span> <a name="line-241"></a><span></span> <a name="line-242"></a><span class="hs-comment">-- | Cayley-Dickson quaternion isomorphism (one way)</span> <span></span> <a name="line-243"></a><span class="hs-identifier">complicate&#39;</span> <span></span> <span class="hs-glyph">::</span> <span></span> <a href="Numeric.Algebra.Complex.Class.html#Complicated"><span class="hs-identifier hs-type">Complicated</span> </a><span></span> <a href="#local-1627544323"><span class="hs-identifier hs-type">c</span> </a><span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544323"><span class="hs-identifier hs-type">c</span> </a><span></span> <span class="hs-special">,</span> <span></span> <a href="#local-1627544323"><span class="hs-identifier hs-type">c</span> </a><span class="hs-special">)</span> <span></span> <a name="line-244"></a><a name="complicate%27"><a href="Numeric.Coalgebra.Quaternion.html#complicate%27"><span class="hs-identifier">complicate&#39;</span> </a></a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Distinguished.Class.html#e"><span class="hs-identifier hs-var">e</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Distinguished.Class.html#e"><span class="hs-identifier hs-var">e</span> </a><span class="hs-special">)</span> <span></span> <a name="line-245"></a><span class="hs-identifier">complicate&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Complex.Class.html#i"><span class="hs-identifier hs-var">i</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Distinguished.Class.html#e"><span class="hs-identifier hs-var">e</span> </a><span class="hs-special">)</span> <span></span> <a name="line-246"></a><span class="hs-identifier">complicate&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Distinguished.Class.html#e"><span class="hs-identifier hs-var">e</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Complex.Class.html#i"><span class="hs-identifier hs-var">i</span> </a><span class="hs-special">)</span> <span></span> <a name="line-247"></a><span class="hs-identifier">complicate&#39;</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Complex.Class.html#i"><span class="hs-identifier hs-var">i</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Complex.Class.html#i"><span class="hs-identifier hs-var">i</span> </a><span class="hs-special">)</span> <span></span> <a name="line-248"></a><span></span> <a name="line-249"></a><span class="hs-identifier">scalarPart&#39;</span> <span></span> <span class="hs-glyph">::</span> <span></span> <span class="hs-special">(</span> <span class="hs-identifier hs-type">Representable</span> <span></span> <a href="#local-1627544321"><span class="hs-identifier hs-type">f</span> </a><span class="hs-special">,</span> <span></span> <span class="hs-identifier hs-type">Rep</span> <span></span> <a href="#local-1627544321"><span class="hs-identifier hs-type">f</span> </a><span></span> <span class="hs-glyph">~</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="#local-1627544321"><span class="hs-identifier hs-type">f</span> </a><span></span> <a href="#local-1627544322"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <a href="#local-1627544322"><span class="hs-identifier hs-type">r</span> </a><span></span> <a name="line-250"></a><a name="scalarPart%27"><a href="Numeric.Coalgebra.Quaternion.html#scalarPart%27"><span class="hs-identifier">scalarPart&#39;</span> </a></a><span></span> <a name="local-1627544324"><a href="#local-1627544324"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-identifier hs-var">index</span> <span></span> <a href="#local-1627544324"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#E%27"><span class="hs-identifier hs-var">E&#39;</span> </a><span></span> <a name="line-251"></a><span></span> <a name="line-252"></a><span class="hs-identifier">vectorPart&#39;</span> <span></span> <span class="hs-glyph">::</span> <span></span> <span class="hs-special">(</span> <span class="hs-identifier hs-type">Representable</span> <span></span> <a href="#local-1627544319"><span class="hs-identifier hs-type">f</span> </a><span class="hs-special">,</span> <span></span> <span class="hs-identifier hs-type">Rep</span> <span></span> <a href="#local-1627544319"><span class="hs-identifier hs-type">f</span> </a><span></span> <span class="hs-glyph">~</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#QuaternionBasis%27"><span class="hs-identifier hs-type">QuaternionBasis&#39;</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="#local-1627544319"><span class="hs-identifier hs-type">f</span> </a><span></span> <a href="#local-1627544320"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-glyph">-&gt;</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544320"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <a href="#local-1627544320"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <a href="#local-1627544320"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <a name="line-253"></a><a name="vectorPart%27"><a href="Numeric.Coalgebra.Quaternion.html#vectorPart%27"><span class="hs-identifier">vectorPart&#39;</span> </a></a><span></span> <a name="local-1627544325"><a href="#local-1627544325"><span class="hs-identifier">f</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <span class="hs-special">(</span> <span class="hs-identifier hs-var">index</span> <span></span> <a href="#local-1627544325"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#I%27"><span class="hs-identifier hs-var">I&#39;</span> </a><span class="hs-special">,</span> <span></span> <span class="hs-identifier hs-var">index</span> <span></span> <a href="#local-1627544325"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#J%27"><span class="hs-identifier hs-var">J&#39;</span> </a><span class="hs-special">,</span> <span></span> <span class="hs-identifier hs-var">index</span> <span></span> <a href="#local-1627544325"><span class="hs-identifier hs-var">f</span> </a><span></span> <a href="Numeric.Coalgebra.Quaternion.html#K%27"><span class="hs-identifier hs-var">K&#39;</span> </a><span class="hs-special">)</span> <span></span> <a name="line-254"></a><span></span> <a name="line-255"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544333"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Rng.Class.html#Rng"><span class="hs-identifier hs-type">Rng</span> </a><span></span> <a href="#local-1627544333"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Quadrance.Class.html#Quadrance"><span class="hs-identifier hs-type">Quadrance</span> </a><span></span> <a href="#local-1627544333"><span class="hs-identifier hs-type">r</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544333"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-256"></a><span></span> <a name="local-1912719355"><a href="Numeric.Quadrance.Class.html#quadrance"><span class="hs-identifier">quadrance</span> </a></a><span></span> <a name="local-1627544334"><a href="#local-1627544334"><span class="hs-identifier">n</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#scalarPart%27"><span class="hs-identifier hs-var">scalarPart&#39;</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#adjoint"><span class="hs-identifier hs-var">adjoint</span> </a><span></span> <a href="#local-1627544334"><span class="hs-identifier hs-var">n</span> </a><span></span> <a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator hs-var">*</span> </a><span></span> <a href="#local-1627544334"><span class="hs-identifier hs-var">n</span> </a><span class="hs-special">)</span> <span></span> <a name="line-257"></a><span></span> <a name="line-258"></a><span class="hs-keyword">instance</span> <span></span> <span class="hs-special">(</span> <a href="Numeric.Algebra.Involutive.html#TriviallyInvolutive"><span class="hs-identifier hs-type">TriviallyInvolutive</span> </a><span></span> <a href="#local-1627544326"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Ring.Class.html#Ring"><span class="hs-identifier hs-type">Ring</span> </a><span></span> <a href="#local-1627544326"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">,</span> <span></span> <a href="Numeric.Algebra.Division.html#Division"><span class="hs-identifier hs-type">Division</span> </a><span></span> <a href="#local-1627544326"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=&gt;</span> <span></span> <a href="Numeric.Algebra.Division.html#Division"><span class="hs-identifier hs-type">Division</span> </a><span></span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-type">Quaternion&#39;</span> </a><span></span> <a href="#local-1627544326"><span class="hs-identifier hs-type">r</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-keyword">where</span> <span></span> <a name="line-259"></a><span></span> <a name="local-1912656201"><a href="Numeric.Algebra.Division.html#recip"><span class="hs-identifier">recip</span> </a></a><span></span> <a name="local-1627544327"><a href="#local-1627544327"><span class="hs-identifier">q</span> </a></a><span class="hs-glyph">@</span> <span class="hs-special">(</span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <a name="local-1627544328"><a href="#local-1627544328"><span class="hs-identifier">a</span> </a></a><span></span> <a name="local-1627544329"><a href="#local-1627544329"><span class="hs-identifier">b</span> </a></a><span></span> <a name="local-1627544330"><a href="#local-1627544330"><span class="hs-identifier">c</span> </a></a><span></span> <a name="local-1627544331"><a href="#local-1627544331"><span class="hs-identifier">d</span> </a></a><span class="hs-special">)</span> <span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Coalgebra.Quaternion.html#Quaternion%27"><span class="hs-identifier hs-var">Quaternion&#39;</span> </a><span></span> <span class="hs-special">(</span> <a href="#local-1627544332"><span class="hs-identifier hs-var">qq</span> </a><span></span> <a href="Numeric.Algebra.Division.html#%5C%5C"><span class="hs-operator hs-var">\\</span> </a><span></span> <a href="#local-1627544328"><span class="hs-identifier hs-var">a</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544332"><span class="hs-identifier hs-var">qq</span> </a><span></span> <a href="Numeric.Algebra.Division.html#%5C%5C"><span class="hs-operator hs-var">\\</span> </a><span></span> <a href="#local-1627544329"><span class="hs-identifier hs-var">b</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544332"><span class="hs-identifier hs-var">qq</span> </a><span></span> <a href="Numeric.Algebra.Division.html#%5C%5C"><span class="hs-operator hs-var">\\</span> </a><span></span> <a href="#local-1627544330"><span class="hs-identifier hs-var">c</span> </a><span class="hs-special">)</span> <span></span> <span class="hs-special">(</span> <a href="#local-1627544332"><span class="hs-identifier hs-var">qq</span> </a><span></span> <a href="Numeric.Algebra.Division.html#%5C%5C"><span class="hs-operator hs-var">\\</span> </a><span></span> <a href="#local-1627544331"><span class="hs-identifier hs-var">d</span> </a><span class="hs-special">)</span> <span></span> <a name="line-260"></a><span></span> <span class="hs-keyword">where</span> <span></span> <a name="local-1627544332"><a href="#local-1627544332"><span class="hs-identifier">qq</span> </a></a><span></span> <span class="hs-glyph">=</span> <span></span> <a href="Numeric.Quadrance.Class.html#quadrance"><span class="hs-identifier hs-var">quadrance</span> </a><span></span> <a href="#local-1627544327"><span class="hs-identifier hs-var">q</span> </a><span></span> <a name="line-261"></a></pre></body></html></DOCTYPE>