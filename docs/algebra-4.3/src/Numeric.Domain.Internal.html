<DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;=""><html xmlns="http://www.w3.org/1999/xhtml"><head><link href="style.css" type="text/css" rel="stylesheet"></link><script src="highlight.js" type="text/javascript"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude, FlexibleInstances, UndecidableInstances, DefaultSignatures #-}</span><span></span><a name="line-2"></a><span class="hs-keyword">module</span><span></span><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Domain</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span></span><span class="hs-keyword">where</span><span></span><a name="line-3"></a><span></span><a name="line-4"></a><span class="hs-keyword">import</span><span></span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span class="hs-special">)</span><span></span><a name="line-5"></a><span class="hs-keyword">import</span><span></span><a href="Numeric.Additive.Group.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Additive</span><span class="hs-operator">.</span><span class="hs-identifier">Group</span></a><span></span><a name="line-6"></a><span class="hs-keyword">import</span><span></span><a href="Numeric.Algebra.Class.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span></a><span></span><a name="line-7"></a><span class="hs-keyword">import</span><span></span><a href="Numeric.Algebra.Commutative.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Commutative</span></a><span></span><a name="line-8"></a><span class="hs-keyword">import</span><span></span><a href="Numeric.Algebra.Division.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Division</span></a><span></span><a name="line-9"></a><span class="hs-keyword">import</span><span></span><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Natural</span><span></span><span class="hs-special">(</span><span class="hs-identifier hs-type">Natural</span><span class="hs-special">)</span><span></span><a name="line-10"></a><span class="hs-keyword">import</span><span></span><a href="Numeric.Semiring.ZeroProduct.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Semiring</span><span class="hs-operator">.</span><span class="hs-identifier">ZeroProduct</span></a><span></span><a name="line-11"></a><span class="hs-keyword">import</span><span></span><a href="Numeric.Algebra.Unital.UnitNormalForm.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Unital</span><span class="hs-operator">.</span><span class="hs-identifier">UnitNormalForm</span></a><span></span><a name="line-12"></a><span class="hs-keyword">import</span><span></span><a href="Numeric.Ring.Class.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Ring</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span></a><span></span><a name="line-13"></a><span class="hs-keyword">import</span><span></span><a href="Numeric.Decidable.Zero.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Decidable</span><span class="hs-operator">.</span><span class="hs-identifier">Zero</span></a><span></span><a name="line-14"></a><span class="hs-keyword">import</span><span></span><a href="Numeric.Decidable.Units.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">Decidable</span><span class="hs-operator">.</span><span class="hs-identifier">Units</span></a><span></span><a name="line-15"></a><span></span><a name="line-16"></a><span class="hs-keyword">import</span><span></span><span class="hs-identifier">Prelude</span><span></span><span class="hs-special">(</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span></span><span class="hs-identifier hs-type">Maybe</span><span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span></span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span></span><a name="line-17"></a><span></span><span class="hs-identifier hs-var">otherwise</span><span class="hs-special">,</span><span></span><span class="hs-identifier hs-var">fst</span><span class="hs-special">,</span><span></span><span class="hs-identifier hs-var">snd</span><span class="hs-special">,</span><span></span><span class="hs-special">(</span><span class="hs-operator hs-var">$</span><span class="hs-special">)</span><span class="hs-special">,</span><span></span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><a name="line-18"></a><span class="hs-keyword">import</span><span></span><span class="hs-keyword">qualified</span><span></span><span class="hs-identifier">Prelude</span><span></span><span class="hs-keyword">as</span><span></span><span class="hs-identifier">P</span><span></span><a name="line-19"></a><span></span><a name="line-20"></a><span class="hs-keyword">infixl</span><span></span><span class="hs-number">7</span><span></span><span class="hs-special">`</span><span class="hs-identifier">quot</span><span class="hs-special">`</span><span class="hs-special">,</span><span></span><span class="hs-special">`</span><span class="hs-identifier">rem</span><span class="hs-special">`</span><span></span><a name="line-21"></a><span class="hs-keyword">infix</span><span></span><span class="hs-number">7</span><span></span><span class="hs-special">`</span><span class="hs-identifier">divide</span><span class="hs-special">`</span><span class="hs-special">,</span><span></span><span class="hs-special">`</span><span class="hs-identifier">divides</span><span class="hs-special">`</span><span class="hs-special">,</span><span></span><span class="hs-special">`</span><span class="hs-identifier">maybeQuot</span><span class="hs-special">`</span><span></span><a name="line-22"></a><span></span><a name="line-23"></a><span class="hs-comment">-- | (Integral) domain is the integral semiring.</span><span></span><a name="line-24"></a><span class="hs-keyword">class</span><span></span><span class="hs-special">(</span><a href="Numeric.Semiring.ZeroProduct.html#ZeroProductSemiring"><span class="hs-identifier hs-type">ZeroProductSemiring</span></a><span></span><a href="#local-1627475985"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span></span><a href="Numeric.Ring.Class.html#Ring"><span class="hs-identifier hs-type">Ring</span></a><span></span><a href="#local-1627475985"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a name="Domain"><a href="Numeric.Domain.Internal.html#Domain"><span class="hs-identifier">Domain</span></a></a><span></span><a name="local-1627475985"><a href="#local-1627475985"><span class="hs-identifier">d</span></a></a><span></span><a name="line-25"></a><span class="hs-keyword">instance</span><span></span><span class="hs-special">(</span><a href="Numeric.Semiring.ZeroProduct.html#ZeroProductSemiring"><span class="hs-identifier hs-type">ZeroProductSemiring</span></a><span></span><a href="#local-1627476009"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span></span><a href="Numeric.Ring.Class.html#Ring"><span class="hs-identifier hs-type">Ring</span></a><span></span><a href="#local-1627476009"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a href="Numeric.Domain.Internal.html#Domain"><span class="hs-identifier hs-type">Domain</span></a><span></span><a href="#local-1627476009"><span class="hs-identifier hs-type">d</span></a><span></span><a name="line-26"></a><span></span><a name="line-27"></a><span class="hs-comment">-- | An integral domain is a commutative domain in which 1â‰ 0.</span><span></span><a name="line-28"></a><span class="hs-keyword">class</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#Domain"><span class="hs-identifier hs-type">Domain</span></a><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span></span><a href="Numeric.Algebra.Commutative.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a name="IntegralDomain"><a href="Numeric.Domain.Internal.html#IntegralDomain"><span class="hs-identifier">IntegralDomain</span></a></a><span></span><a name="local-1627475978"><a href="#local-1627475978"><span class="hs-identifier">d</span></a></a><span></span><span class="hs-keyword">where</span><span></span><a name="line-29"></a><span></span><span class="hs-identifier">divides</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-identifier hs-type">Bool</span><span></span><a name="line-30"></a><span></span><span class="hs-keyword">default</span><span></span><span class="hs-identifier">divides</span><span></span><span class="hs-glyph">::</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#Euclidean"><span class="hs-identifier hs-type">Euclidean</span></a><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-identifier hs-type">Bool</span><span></span><a name="line-31"></a><span></span><a name="local-1627475979"><a href="#local-1627475979"><span class="hs-identifier">m</span></a></a><span></span><span class="hs-special">`</span><a name="local-1912688623"><a href="Numeric.Domain.Internal.html#divides"><span class="hs-identifier">divides</span></a></a><span class="hs-special">`</span><span></span><a name="local-1627475980"><a href="#local-1627475980"><span class="hs-identifier">n</span></a></a><span></span><span></span><a name="line-32"></a><span></span><span class="hs-glyph">|</span><span></span><a href="Numeric.Decidable.Zero.html#isZero"><span class="hs-identifier hs-var">isZero</span></a><span></span><a href="#local-1627475979"><span class="hs-identifier hs-var">m</span></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">False</span><span></span><a name="line-33"></a><span></span><span class="hs-glyph">|</span><span></span><span class="hs-identifier hs-var">otherwise</span><span></span><span class="hs-glyph">=</span><span></span><a href="Numeric.Decidable.Zero.html#isZero"><span class="hs-identifier hs-var">isZero</span></a><span></span><span class="hs-special">(</span><a href="#local-1627475980"><span class="hs-identifier hs-var">n</span></a><span></span><span class="hs-special">`</span><a href="Numeric.Domain.Internal.html#rem"><span class="hs-identifier hs-var">rem</span></a><span class="hs-special">`</span><span></span><a href="#local-1627475979"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><a name="line-34"></a><span></span><span class="hs-identifier">maybeQuot</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-identifier hs-type">Maybe</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><a name="line-35"></a><span></span><span class="hs-keyword">default</span><span></span><span class="hs-identifier">maybeQuot</span><span></span><span class="hs-glyph">::</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#Euclidean"><span class="hs-identifier hs-type">Euclidean</span></a><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-identifier hs-type">Maybe</span><span></span><a href="#local-1627475978"><span class="hs-identifier hs-type">d</span></a><span></span><a name="line-36"></a><span></span><a name="local-1627475981"><a href="#local-1627475981"><span class="hs-identifier">m</span></a></a><span></span><span class="hs-special">`</span><a name="local-1912688624"><a href="Numeric.Domain.Internal.html#maybeQuot"><span class="hs-identifier">maybeQuot</span></a></a><span class="hs-special">`</span><span></span><a name="local-1627475982"><a href="#local-1627475982"><span class="hs-identifier">n</span></a></a><span></span><a name="line-37"></a><span></span><span class="hs-glyph">|</span><span></span><a href="Numeric.Decidable.Zero.html#isZero"><span class="hs-identifier hs-var">isZero</span></a><span></span><a href="#local-1627475982"><span class="hs-identifier hs-var">n</span></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">Nothing</span><span></span><a name="line-38"></a><span></span><span class="hs-glyph">|</span><span></span><span class="hs-identifier hs-var">otherwise</span><span></span><span class="hs-glyph">=</span><span></span><span class="hs-keyword">let</span><span></span><span class="hs-special">(</span><a name="local-1627475983"><a href="#local-1627475983"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><a name="local-1627475984"><a href="#local-1627475984"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=</span><span></span><a href="#local-1627475981"><span class="hs-identifier hs-var">m</span></a><span></span><span class="hs-special">`</span><a href="Numeric.Domain.Internal.html#divide"><span class="hs-identifier hs-var">divide</span></a><span class="hs-special">`</span><span></span><a href="#local-1627475982"><span class="hs-identifier hs-var">n</span></a><span></span><span class="hs-keyword">in</span><span></span><a name="line-39"></a><span></span><span class="hs-keyword">if</span><span></span><a href="Numeric.Decidable.Zero.html#isZero"><span class="hs-identifier hs-var">isZero</span></a><span></span><a href="#local-1627475984"><span class="hs-identifier hs-var">r</span></a><span></span><span class="hs-keyword">then</span><span></span><span class="hs-identifier hs-var">Just</span><span></span><a href="#local-1627475983"><span class="hs-identifier hs-var">q</span></a><span></span><span class="hs-keyword">else</span><span></span><span class="hs-identifier hs-var">Nothing</span><span></span><a name="line-40"></a><span></span><a name="line-41"></a><span class="hs-keyword">instance</span><span></span><a href="Numeric.Domain.Internal.html#IntegralDomain"><span class="hs-identifier hs-type">IntegralDomain</span></a><span></span><span class="hs-identifier hs-type">Integer</span><span></span><a name="line-42"></a><span></span><a name="line-43"></a><span class="hs-keyword">class</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#IntegralDomain"><span class="hs-identifier hs-type">IntegralDomain</span></a><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span></span><a href="Numeric.Algebra.Unital.UnitNormalForm.html#UnitNormalForm"><span class="hs-identifier hs-type">UnitNormalForm</span></a><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span></span><a href="Numeric.Decidable.Zero.html#DecidableZero"><span class="hs-identifier hs-type">DecidableZero</span></a><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a name="GCDDomain"><a href="Numeric.Domain.Internal.html#GCDDomain"><span class="hs-identifier">GCDDomain</span></a></a><span></span><a name="local-1627475969"><a href="#local-1627475969"><span class="hs-identifier">d</span></a></a><span></span><span class="hs-keyword">where</span><span></span><a name="line-44"></a><span></span><span class="hs-identifier">gcd</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><a name="line-45"></a><span></span><span class="hs-keyword">default</span><span></span><span class="hs-identifier">gcd</span><span></span><span class="hs-glyph">::</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#PID"><span class="hs-identifier hs-type">PID</span></a><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><a name="line-46"></a><span></span><a name="local-1912688619"><a href="Numeric.Domain.Internal.html#gcd"><span class="hs-identifier">gcd</span></a></a><span></span><a name="local-1627475970"><a href="#local-1627475970"><span class="hs-identifier">a</span></a></a><span></span><a name="local-1627475971"><a href="#local-1627475971"><span class="hs-identifier">b</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-keyword">let</span><span></span><span class="hs-special">(</span><a name="local-1627475972"><a href="#local-1627475972"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span></span><span class="hs-glyph">=</span><span></span><a href="Numeric.Domain.Internal.html#egcd"><span class="hs-identifier hs-var">egcd</span></a><span></span><a href="#local-1627475970"><span class="hs-identifier hs-var">a</span></a><span></span><a href="#local-1627475971"><span class="hs-identifier hs-var">b</span></a><span></span><span class="hs-keyword">in</span><span></span><a href="#local-1627475972"><span class="hs-identifier hs-var">r</span></a><span></span><a name="line-47"></a><span></span><span class="hs-pragma">{-# INLINE gcd #-}</span><span></span><a name="line-48"></a><span></span><a name="line-49"></a><span></span><span class="hs-identifier">reduceFraction</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-special">(</span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><a name="line-50"></a><span></span><a name="local-1912688620"><a href="Numeric.Domain.Internal.html#reduceFraction"><span class="hs-identifier">reduceFraction</span></a></a><span></span><a name="local-1627475973"><a href="#local-1627475973"><span class="hs-identifier">a</span></a></a><span></span><a name="local-1627475974"><a href="#local-1627475974"><span class="hs-identifier">b</span></a></a><span></span><span class="hs-glyph">=</span><span></span><a name="line-51"></a><span></span><span class="hs-keyword">let</span><span></span><a name="local-1627475975"><a href="#local-1627475975"><span class="hs-identifier">c</span></a></a><span></span><span class="hs-glyph">=</span><span></span><a href="Numeric.Domain.Internal.html#gcd"><span class="hs-identifier hs-var">gcd</span></a><span></span><a href="#local-1627475973"><span class="hs-identifier hs-var">a</span></a><span></span><a href="#local-1627475974"><span class="hs-identifier hs-var">b</span></a><span></span><span class="hs-keyword">in</span><span></span><a name="line-52"></a><span></span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span></span><span class="hs-special">(</span><a href="#local-1627475973"><span class="hs-identifier hs-var">a</span></a><span></span><span class="hs-special">`</span><a href="Numeric.Domain.Internal.html#maybeQuot"><span class="hs-identifier hs-var">maybeQuot</span></a><span class="hs-special">`</span><span></span><a href="#local-1627475975"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span></span><span class="hs-identifier hs-var">fromJust</span><span></span><span class="hs-special">(</span><a href="#local-1627475974"><span class="hs-identifier hs-var">b</span></a><span></span><span class="hs-special">`</span><a href="Numeric.Domain.Internal.html#maybeQuot"><span class="hs-identifier hs-var">maybeQuot</span></a><span class="hs-special">`</span><span></span><a href="#local-1627475975"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><a name="line-53"></a><span></span><a name="line-54"></a><span></span><span class="hs-identifier">lcm</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475969"><span class="hs-identifier hs-type">d</span></a><span></span><a name="line-55"></a><span></span><a name="local-1912688621"><a href="Numeric.Domain.Internal.html#lcm"><span class="hs-identifier">lcm</span></a></a><span></span><a name="local-1627475976"><a href="#local-1627475976"><span class="hs-identifier">p</span></a></a><span></span><a name="local-1627475977"><a href="#local-1627475977"><span class="hs-identifier">q</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">fromJust</span><span></span><span class="hs-operator hs-var">$</span><span></span><span class="hs-special">(</span><a href="#local-1627475976"><span class="hs-identifier hs-var">p</span></a><span></span><a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator hs-var">*</span></a><span></span><a href="#local-1627475977"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span></span><span class="hs-special">`</span><a href="Numeric.Domain.Internal.html#maybeQuot"><span class="hs-identifier hs-var">maybeQuot</span></a><span class="hs-special">`</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#gcd"><span class="hs-identifier hs-var">gcd</span></a><span></span><a href="#local-1627475976"><span class="hs-identifier hs-var">p</span></a><span></span><a href="#local-1627475977"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span></span><a name="line-56"></a><span></span><a name="line-57"></a><span class="hs-keyword">instance</span><span></span><a href="Numeric.Domain.Internal.html#GCDDomain"><span class="hs-identifier hs-type">GCDDomain</span></a><span></span><span class="hs-identifier hs-type">Integer</span><span></span><a name="line-58"></a><span></span><a name="line-59"></a><span class="hs-keyword">class</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#GCDDomain"><span class="hs-identifier hs-type">GCDDomain</span></a><span></span><a href="#local-1627475968"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a name="UFD"><a href="Numeric.Domain.Internal.html#UFD"><span class="hs-identifier">UFD</span></a></a><span></span><a name="local-1627475968"><a href="#local-1627475968"><span class="hs-identifier">d</span></a></a><span></span><a name="line-60"></a><span></span><a name="line-61"></a><span class="hs-keyword">instance</span><span></span><a href="Numeric.Domain.Internal.html#UFD"><span class="hs-identifier hs-type">UFD</span></a><span></span><span class="hs-identifier hs-type">Integer</span><span></span><a name="line-62"></a><span></span><a name="line-63"></a><span class="hs-keyword">class</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#UFD"><span class="hs-identifier hs-type">UFD</span></a><span></span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a name="PID"><a href="Numeric.Domain.Internal.html#PID"><span class="hs-identifier">PID</span></a></a><span></span><a name="local-1627475965"><a href="#local-1627475965"><span class="hs-identifier">d</span></a></a><span></span><span class="hs-keyword">where</span><span></span><a name="line-64"></a><span></span><span class="hs-identifier">egcd</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-special">(</span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><a name="line-65"></a><span></span><span class="hs-keyword">default</span><span></span><span class="hs-identifier">egcd</span><span></span><span class="hs-glyph">::</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#Euclidean"><span class="hs-identifier hs-type">Euclidean</span></a><span></span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-special">(</span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-1627475965"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><a name="line-66"></a><span></span><a name="local-1912688616"><a href="Numeric.Domain.Internal.html#egcd"><span class="hs-identifier">egcd</span></a></a><span></span><a name="local-1627475966"><a href="#local-1627475966"><span class="hs-identifier">a</span></a></a><span></span><a name="local-1627475967"><a href="#local-1627475967"><span class="hs-identifier">b</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">head</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#euclid"><span class="hs-identifier hs-var">euclid</span></a><span></span><a href="#local-1627475966"><span class="hs-identifier hs-var">a</span></a><span></span><a href="#local-1627475967"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span></span><a name="line-67"></a><span></span><span class="hs-pragma">{-# INLINE egcd #-}</span><span></span><a name="line-68"></a><span></span><a name="line-69"></a><span class="hs-keyword">instance</span><span></span><a href="Numeric.Domain.Internal.html#PID"><span class="hs-identifier hs-type">PID</span></a><span></span><span class="hs-identifier hs-type">Integer</span><span></span><a name="line-70"></a><span></span><a name="line-71"></a><span class="hs-keyword">class</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#PID"><span class="hs-identifier hs-type">PID</span></a><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a name="Euclidean"><a href="Numeric.Domain.Internal.html#Euclidean"><span class="hs-identifier">Euclidean</span></a></a><span></span><a name="local-1627475956"><a href="#local-1627475956"><span class="hs-identifier">d</span></a></a><span></span><span class="hs-keyword">where</span><span></span><a name="line-72"></a><span></span><span class="hs-comment">-- | Euclidean (degree) function on @r@.</span><span></span><a name="line-73"></a><span></span><span class="hs-identifier">degree</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-identifier hs-type">Maybe</span><span></span><span class="hs-identifier hs-type">Natural</span><span></span><a name="line-74"></a><span></span><span class="hs-keyword">default</span><span></span><span class="hs-identifier">degree</span><span></span><span class="hs-glyph">::</span><span></span><span class="hs-special">(</span><a href="Numeric.Algebra.Division.html#Division"><span class="hs-identifier hs-type">Division</span></a><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-identifier hs-type">Maybe</span><span></span><span class="hs-identifier hs-type">Natural</span><span></span><a name="line-75"></a><span></span><a name="local-1912688611"><a href="Numeric.Domain.Internal.html#degree"><span class="hs-identifier">degree</span></a></a><span></span><a name="local-1627475957"><a href="#local-1627475957"><span class="hs-identifier">a</span></a></a><span></span><span class="hs-glyph">|</span><span></span><a href="Numeric.Decidable.Zero.html#isZero"><span class="hs-identifier hs-var">isZero</span></a><span></span><a href="#local-1627475957"><span class="hs-identifier hs-var">a</span></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">Nothing</span><span></span><a name="line-76"></a><span></span><span class="hs-glyph">|</span><span></span><span class="hs-identifier hs-var">otherwise</span><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">Just</span><span></span><a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span></a><span></span><a name="line-77"></a><span></span><span class="hs-comment">-- | Division algorithm. @a `divide` b@ calculates</span><span></span><a name="line-78"></a><span></span><span class="hs-comment">--   quotient and remainder of @a@ divided by @b@.</span><span></span><a name="line-79"></a><span></span><span class="hs-comment">--</span><span></span><a name="line-80"></a><span></span><span class="hs-comment">-- prop&gt; let (q, r) = divide a p in p*q + r == a &amp;&amp; degree r &lt; degree q</span><span></span><a name="line-81"></a><span></span><span class="hs-identifier">divide</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-comment">-- ^ elements divided by</span><span></span><a name="line-82"></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-comment">-- ^ divisor</span><span></span><a name="line-83"></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-special">(</span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-comment">-- ^ quotient and remainder</span><span></span><a name="line-84"></a><span></span><span class="hs-keyword">default</span><span></span><span class="hs-identifier">divide</span><span></span><span class="hs-glyph">::</span><span></span><span class="hs-special">(</span><a href="Numeric.Algebra.Division.html#Division"><span class="hs-identifier hs-type">Division</span></a><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-special">(</span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><a name="line-85"></a><span></span><span class="hs-comment">-- Be strict in order to make sure division by zero gets caught</span><span></span><a name="line-86"></a><span></span><a name="local-1912688612"><a href="Numeric.Domain.Internal.html#divide"><span class="hs-identifier">divide</span></a></a><span></span><a name="local-1627475958"><a href="#local-1627475958"><span class="hs-identifier">a</span></a></a><span></span><a name="local-1627475959"><a href="#local-1627475959"><span class="hs-identifier">b</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-keyword">let</span><span></span><a name="local-1627475960"><a href="#local-1627475960"><span class="hs-identifier">q</span></a></a><span></span><span class="hs-glyph">=</span><span></span><a href="#local-1627475958"><span class="hs-identifier hs-var">a</span></a><a href="Numeric.Algebra.Division.html#%2F"><span class="hs-operator hs-var">/</span></a><a href="#local-1627475959"><span class="hs-identifier hs-var">b</span></a><span></span><span class="hs-keyword">in</span><span></span><span class="hs-special">(</span><a href="#local-1627475960"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">seq</span><span></span><a href="#local-1627475960"><span class="hs-identifier hs-var">q</span></a><span></span><a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span></a><span class="hs-special">)</span><span></span><a name="line-87"></a><span></span><a name="line-88"></a><span></span><span class="hs-identifier">quot</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><a name="line-89"></a><span></span><a name="local-1912688613"><a href="Numeric.Domain.Internal.html#quot"><span class="hs-identifier">quot</span></a></a><span></span><a name="local-1627475961"><a href="#local-1627475961"><span class="hs-identifier">a</span></a></a><span></span><a name="local-1627475962"><a href="#local-1627475962"><span class="hs-identifier">b</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">fst</span><span></span><span class="hs-operator hs-var">$</span><span></span><a href="#local-1627475961"><span class="hs-identifier hs-var">a</span></a><span></span><span class="hs-special">`</span><a href="Numeric.Domain.Internal.html#divide"><span class="hs-identifier hs-var">divide</span></a><span class="hs-special">`</span><span></span><a href="#local-1627475962"><span class="hs-identifier hs-var">b</span></a><span></span><a name="line-90"></a><span></span><span class="hs-pragma">{-# INLINE quot #-}</span><span></span><a name="line-91"></a><span></span><a name="line-92"></a><span></span><span class="hs-identifier">rem</span><span></span><span class="hs-glyph">::</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475956"><span class="hs-identifier hs-type">d</span></a><span></span><a name="line-93"></a><span></span><a name="local-1912688614"><a href="Numeric.Domain.Internal.html#rem"><span class="hs-identifier">rem</span></a></a><span></span><a name="local-1627475963"><a href="#local-1627475963"><span class="hs-identifier">a</span></a></a><span></span><a name="local-1627475964"><a href="#local-1627475964"><span class="hs-identifier">b</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">snd</span><span></span><span class="hs-operator hs-var">$</span><span></span><a href="#local-1627475963"><span class="hs-identifier hs-var">a</span></a><span></span><span class="hs-special">`</span><a href="Numeric.Domain.Internal.html#divide"><span class="hs-identifier hs-var">divide</span></a><span class="hs-special">`</span><span></span><a href="#local-1627475964"><span class="hs-identifier hs-var">b</span></a><span></span><a name="line-94"></a><span></span><span class="hs-pragma">{-# INLINE rem #-}</span><span></span><a name="line-95"></a><span></span><a name="line-96"></a><span class="hs-keyword">instance</span><span></span><a href="Numeric.Domain.Internal.html#Euclidean"><span class="hs-identifier hs-type">Euclidean</span></a><span></span><span class="hs-identifier hs-type">Integer</span><span></span><span class="hs-keyword">where</span><span></span><a name="line-97"></a><span></span><a name="local-1912688611"><a href="Numeric.Domain.Internal.html#degree"><span class="hs-identifier">degree</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">Just</span><span></span><span class="hs-operator hs-var">.</span><span></span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromInteger</span><span></span><span class="hs-operator hs-var">.</span><span></span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">abs</span><span></span><a name="line-98"></a><span></span><span class="hs-pragma">{-# INLINE degree #-}</span><span></span><a name="line-99"></a><span></span><a name="line-100"></a><span></span><a name="local-1912688612"><a href="Numeric.Domain.Internal.html#divide"><span class="hs-identifier">divide</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">divMod</span><span></span><a name="line-101"></a><span></span><span class="hs-pragma">{-# INLINE divide #-}</span><span></span><a name="line-102"></a><span></span><a name="line-103"></a><span></span><a name="line-104"></a><span class="hs-comment">-- | Extended euclidean algorithm.</span><span></span><a name="line-105"></a><span class="hs-comment">--</span><span></span><a name="line-106"></a><span class="hs-comment">-- prop&gt; euclid f g == xs ==&gt; all (\(r, s, t) -&gt; r == f * s + g * t) xs</span><span></span><a name="line-107"></a><span class="hs-identifier">euclid</span><span></span><span class="hs-glyph">::</span><span></span><span class="hs-special">(</span><a href="Numeric.Domain.Internal.html#Euclidean"><span class="hs-identifier hs-type">Euclidean</span></a><span></span><a href="#local-1627475986"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=&gt;</span><span></span><a href="#local-1627475986"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><a href="#local-1627475986"><span class="hs-identifier hs-type">d</span></a><span></span><span class="hs-glyph">-&gt;</span><span></span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627475986"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-1627475986"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-1627475986"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span></span><a name="line-108"></a><a name="euclid"><a href="Numeric.Domain.Internal.html#euclid"><span class="hs-identifier">euclid</span></a></a><span></span><a name="local-1627475987"><a href="#local-1627475987"><span class="hs-identifier">f</span></a></a><span></span><a name="local-1627475988"><a href="#local-1627475988"><span class="hs-identifier">g</span></a></a><span></span><span class="hs-glyph">=</span><span></span><a name="line-109"></a><span></span><span class="hs-keyword">let</span><span></span><span class="hs-special">(</span><a name="local-1627476003"><a href="#local-1627476003"><span class="hs-identifier">ug</span></a></a><span class="hs-special">,</span><span></span><a name="local-1627476004"><a href="#local-1627476004"><span class="hs-identifier">g&#39;</span></a></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=</span><span></span><a href="Numeric.Algebra.Unital.UnitNormalForm.html#splitUnit"><span class="hs-identifier hs-var">splitUnit</span></a><span></span><a href="#local-1627475988"><span class="hs-identifier hs-var">g</span></a><span></span><a name="line-110"></a><span></span><span class="hs-identifier hs-var">Just</span><span></span><a name="local-1627476005"><a href="#local-1627476005"><span class="hs-identifier">t&#39;</span></a></a><span></span><span class="hs-glyph">=</span><span></span><a href="Numeric.Decidable.Units.html#recipUnit"><span class="hs-identifier hs-var">recipUnit</span></a><span></span><a href="#local-1627476003"><span class="hs-identifier hs-var">ug</span></a><span></span><a name="line-111"></a><span></span><span class="hs-special">(</span><a name="local-1627476006"><a href="#local-1627476006"><span class="hs-identifier">uf</span></a></a><span class="hs-special">,</span><span></span><a name="local-1627476007"><a href="#local-1627476007"><span class="hs-identifier">f&#39;</span></a></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=</span><span></span><a href="Numeric.Algebra.Unital.UnitNormalForm.html#splitUnit"><span class="hs-identifier hs-var">splitUnit</span></a><span></span><a href="#local-1627475987"><span class="hs-identifier hs-var">f</span></a><span></span><a name="line-112"></a><span></span><span class="hs-identifier hs-var">Just</span><span></span><a name="local-1627476008"><a href="#local-1627476008"><span class="hs-identifier">s</span></a></a><span></span><span class="hs-glyph">=</span><span></span><a href="Numeric.Decidable.Units.html#recipUnit"><span class="hs-identifier hs-var">recipUnit</span></a><span></span><a href="#local-1627476006"><span class="hs-identifier hs-var">uf</span></a><span></span><a name="line-113"></a><span></span><span class="hs-keyword">in</span><span></span><a href="#local-1627475989"><span class="hs-identifier hs-var">step</span></a><span></span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627476004"><span class="hs-identifier hs-var">g&#39;</span></a><span class="hs-special">,</span><span></span><a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span></a><span class="hs-special">,</span><span></span><a href="#local-1627476005"><span class="hs-identifier hs-var">t&#39;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span></span><span class="hs-special">(</span><a href="#local-1627476007"><span class="hs-identifier hs-var">f&#39;</span></a><span class="hs-special">,</span><span></span><a href="#local-1627476008"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span></span><a href="Numeric.Algebra.Class.html#zero"><span class="hs-identifier hs-var">zero</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span></span><a name="line-114"></a><span></span><span class="hs-keyword">where</span><span></span><a name="line-115"></a><span></span><a name="local-1627475989"><a href="#local-1627475989"><span class="hs-identifier">step</span></a></a><span></span><a name="local-1627475990"><a href="#local-1627475990"><span class="hs-identifier">acc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-1627475991"><a href="#local-1627475991"><span class="hs-identifier">r&#39;</span></a></a><span class="hs-special">,</span><a name="local-1627475992"><a href="#local-1627475992"><span class="hs-identifier">s&#39;</span></a></a><span class="hs-special">,</span><a name="local-1627475993"><a href="#local-1627475993"><span class="hs-identifier">t&#39;</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-1627475994"><a href="#local-1627475994"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><a name="local-1627475995"><a href="#local-1627475995"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-1627475996"><a href="#local-1627475996"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span></span><a name="line-116"></a><span></span><span class="hs-glyph">|</span><span></span><a href="Numeric.Decidable.Zero.html#isZero"><span class="hs-identifier hs-var">isZero</span></a><span></span><a href="#local-1627475991"><span class="hs-identifier hs-var">r&#39;</span></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">tail</span><span></span><a href="#local-1627475990"><span class="hs-identifier hs-var">acc</span></a><span></span><a name="line-117"></a><span></span><span class="hs-glyph">|</span><span></span><span class="hs-identifier hs-var">otherwise</span><span></span><span class="hs-glyph">=</span><span></span><a name="line-118"></a><span></span><span class="hs-keyword">let</span><span></span><a name="local-1627475997"><a href="#local-1627475997"><span class="hs-identifier">q</span></a></a><span></span><span class="hs-glyph">=</span><span></span><a href="#local-1627475994"><span class="hs-identifier hs-var">r</span></a><span></span><span class="hs-special">`</span><a href="Numeric.Domain.Internal.html#quot"><span class="hs-identifier hs-var">quot</span></a><span class="hs-special">`</span><span></span><a href="#local-1627475991"><span class="hs-identifier hs-var">r&#39;</span></a><span></span><a name="line-119"></a><span></span><span class="hs-special">(</span><a name="local-1627475998"><a href="#local-1627475998"><span class="hs-identifier">ur</span></a></a><span class="hs-special">,</span><span></span><a name="local-1627475999"><a href="#local-1627475999"><span class="hs-identifier">r&#39;&#39;</span></a></a><span class="hs-special">)</span><span></span><span class="hs-glyph">=</span><span></span><a href="Numeric.Algebra.Unital.UnitNormalForm.html#splitUnit"><span class="hs-identifier hs-var">splitUnit</span></a><span></span><span class="hs-operator hs-var">$</span><span></span><a href="#local-1627475994"><span class="hs-identifier hs-var">r</span></a><span></span><span class="hs-glyph">-</span><span></span><a href="#local-1627475997"><span class="hs-identifier hs-var">q</span></a><span></span><a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator hs-var">*</span></a><span></span><a href="#local-1627475991"><span class="hs-identifier hs-var">r&#39;</span></a><span></span><a name="line-120"></a><span></span><span class="hs-identifier hs-var">Just</span><span></span><a name="local-1627476000"><a href="#local-1627476000"><span class="hs-identifier">u</span></a></a><span></span><span class="hs-glyph">=</span><span></span><a href="Numeric.Decidable.Units.html#recipUnit"><span class="hs-identifier hs-var">recipUnit</span></a><span></span><a href="#local-1627475998"><span class="hs-identifier hs-var">ur</span></a><span></span><a name="line-121"></a><span></span><a name="local-1627476001"><a href="#local-1627476001"><span class="hs-identifier">s&#39;&#39;</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-special">(</span><a href="#local-1627475995"><span class="hs-identifier hs-var">s</span></a><span></span><span class="hs-glyph">-</span><span></span><a href="#local-1627475997"><span class="hs-identifier hs-var">q</span></a><span></span><a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator hs-var">*</span></a><span></span><a href="#local-1627475992"><span class="hs-identifier hs-var">s&#39;</span></a><span class="hs-special">)</span><span></span><a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator hs-var">*</span></a><span></span><a href="#local-1627476000"><span class="hs-identifier hs-var">u</span></a><span></span><a name="line-122"></a><span></span><a name="local-1627476002"><a href="#local-1627476002"><span class="hs-identifier">t&#39;&#39;</span></a></a><span></span><span class="hs-glyph">=</span><span></span><span class="hs-special">(</span><a href="#local-1627475996"><span class="hs-identifier hs-var">t</span></a><span></span><span class="hs-glyph">-</span><span></span><a href="#local-1627475997"><span class="hs-identifier hs-var">q</span></a><span></span><a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator hs-var">*</span></a><span></span><a href="#local-1627475993"><span class="hs-identifier hs-var">t&#39;</span></a><span class="hs-special">)</span><span></span><a href="Numeric.Algebra.Class.html#%2A"><span class="hs-operator hs-var">*</span></a><span></span><a href="#local-1627476000"><span class="hs-identifier hs-var">u</span></a><span></span><a name="line-123"></a><span></span><span class="hs-keyword">in</span><span></span><a href="#local-1627475989"><span class="hs-identifier hs-var">step</span></a><span></span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627475999"><span class="hs-identifier hs-var">r&#39;&#39;</span></a><span class="hs-special">,</span><span></span><a href="#local-1627476001"><span class="hs-identifier hs-var">s&#39;&#39;</span></a><span class="hs-special">,</span><span></span><a href="#local-1627476002"><span class="hs-identifier hs-var">t&#39;&#39;</span></a><span class="hs-special">)</span><span></span><span class="hs-glyph">:</span><span></span><a href="#local-1627475990"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span></span><a name="line-124"></a><span></span><span class="hs-identifier">step</span><span></span><span class="hs-identifier">_</span><span></span><span class="hs-glyph">=</span><span></span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">error</span><span></span><span class="hs-string">&quot;cannot happen!&quot;</span><span></span><a name="line-125"></a></pre></body></html></DOCTYPE>