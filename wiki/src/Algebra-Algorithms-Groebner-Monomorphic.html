<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Algebra/Algorithms/Groebner/Monomorphic.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE ConstraintKinds, FlexibleInstances, GADTs, PolyKinds #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE RecordWildCards, ScopedTypeVariables, TypeFamilies   #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE TypeOperators, UndecidableInstances                  #-}</span>
<a name="line-4"></a><span class='hs-comment'>-- | Monomorphic interface for Groenber basis.</span>
<a name="line-5"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Algebra</span><span class='hs-varop'>.</span><span class='hs-conid'>Algorithms</span><span class='hs-varop'>.</span><span class='hs-conid'>Groebner</span><span class='hs-varop'>.</span><span class='hs-conid'>Monomorphic</span>
<a name="line-6"></a>    <span class='hs-layout'>(</span> <span class='hs-conid'>Groebnerable</span>
<a name="line-7"></a>    <span class='hs-comment'>-- * Polynomial division</span>
<a name="line-8"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>divModPolynomial</span><span class='hs-layout'>,</span> <span class='hs-varid'>divPolynomial</span><span class='hs-layout'>,</span> <span class='hs-varid'>modPolynomial</span>
<a name="line-9"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>divModPolynomialWith</span><span class='hs-layout'>,</span> <span class='hs-varid'>divPolynomialWith</span><span class='hs-layout'>,</span> <span class='hs-varid'>modPolynomialWith</span>
<a name="line-10"></a>    <span class='hs-comment'>-- * Groebner basis</span>
<a name="line-11"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>calcGroebnerBasis</span><span class='hs-layout'>,</span> <span class='hs-varid'>calcGroebnerBasisWith</span>
<a name="line-12"></a>    <span class='hs-comment'>-- * Ideal operations</span>
<a name="line-13"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>isIdealMember</span><span class='hs-layout'>,</span> <span class='hs-varid'>intersection</span><span class='hs-layout'>,</span> <span class='hs-varid'>thEliminationIdeal</span><span class='hs-layout'>,</span> <span class='hs-varid'>eliminate</span>
<a name="line-14"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>quotIdeal</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotByPrincipalIdeal</span>
<a name="line-15"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>saturationIdeal</span><span class='hs-layout'>,</span> <span class='hs-varid'>saturationByPrincipalIdeal</span>
<a name="line-16"></a>    <span class='hs-comment'>-- * Re-exports</span>
<a name="line-17"></a>    <span class='hs-layout'>,</span> <span class='hs-conid'>Lex</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Revlex</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Grlex</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Grevlex</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IsOrder</span><span class='hs-layout'>,</span> <span class='hs-conid'>IsMonomialOrder</span>
<a name="line-18"></a>    <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-19"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Algebra</span><span class='hs-varop'>.</span><span class='hs-conid'>Algorithms</span><span class='hs-varop'>.</span><span class='hs-conid'>Groebner</span>         <span class='hs-keyword'>as</span> <span class='hs-conid'>Gr</span>
<a name="line-20"></a><span class='hs-keyword'>import</span>           <span class='hs-conid'>Algebra</span><span class='hs-varop'>.</span><span class='hs-conid'>Internal</span>
<a name="line-21"></a><span class='hs-keyword'>import</span>           <span class='hs-conid'>Algebra</span><span class='hs-varop'>.</span><span class='hs-conid'>Ring</span><span class='hs-varop'>.</span><span class='hs-conid'>Noetherian</span>
<a name="line-22"></a><span class='hs-keyword'>import</span>           <span class='hs-conid'>Algebra</span><span class='hs-varop'>.</span><span class='hs-conid'>Ring</span><span class='hs-varop'>.</span><span class='hs-conid'>Polynomial</span>             <span class='hs-layout'>(</span><span class='hs-conid'>Grevlex</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Grlex</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-23"></a>                                                      <span class='hs-conid'>IsMonomialOrder</span><span class='hs-layout'>,</span> <span class='hs-conid'>IsOrder</span><span class='hs-layout'>,</span>
<a name="line-24"></a>                                                      <span class='hs-conid'>Lex</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Revlex</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-25"></a>                                                      <span class='hs-varid'>orderedBy</span><span class='hs-layout'>)</span>
<a name="line-26"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Algebra</span><span class='hs-varop'>.</span><span class='hs-conid'>Ring</span><span class='hs-varop'>.</span><span class='hs-conid'>Polynomial</span>             <span class='hs-keyword'>as</span> <span class='hs-conid'>Poly</span>
<a name="line-27"></a><span class='hs-keyword'>import</span>           <span class='hs-conid'>Algebra</span><span class='hs-varop'>.</span><span class='hs-conid'>Ring</span><span class='hs-varop'>.</span><span class='hs-conid'>Polynomial</span><span class='hs-varop'>.</span><span class='hs-conid'>Monomorphic</span>
<a name="line-28"></a><span class='hs-keyword'>import</span>           <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Arrow</span>
<a name="line-29"></a><span class='hs-keyword'>import</span>           <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>List</span>
<a name="line-30"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span>                            <span class='hs-keyword'>as</span> <span class='hs-conid'>M</span>
<a name="line-31"></a><span class='hs-keyword'>import</span>           <span class='hs-conid'>Numeric</span><span class='hs-varop'>.</span><span class='hs-conid'>Algebra</span>
<a name="line-32"></a><span class='hs-keyword'>import</span>           <span class='hs-conid'>Prelude</span>                             <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-conid'>Num</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-33"></a>
<a name="line-34"></a><a name="Groebnerable"></a><span class='hs-comment'>-- | Synonym</span>
<a name="line-35"></a><a name="Groebnerable"></a><span class='hs-keyword'>class</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Field</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>NoetherianRing</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span>
<a name="line-36"></a><a name="instance%20Groebnerable%20r%20--%20%7c%20Calculate%20a%20intersection%20of%20given%20ideals.%20intersection%20::%20forall%20r.%20(Groebnerable%20r)%20=%3e%20%5b%5bPolynomial%20r%5d%5d%20-%3e%20%5bPolynomial%20r%5d%20intersection%20ps%20=%20let%20vars%20=%20nub%20$%20sort%20$%20concatMap%20(concatMap%20buildVarsList)%20ps%20dim%20=%20length%20vars%20in%20case%20promote%20dim%20of%20Monomorphic%20sdim%20-%3e%20case%20singInstance%20sdim%20of%20SingInstance%20-%3e%20case%20promote%20ps%20::%20Monomorphic%20(Vector%20%5bPolynomial%20r%5d)%20of%20Monomorphic%20vec%20-%3e%20let%20slen%20=%20sLengthV%20vec%20in%20case%20singInstance%20slen%20of%20SingInstance%20-%3e%20let%20ids%20=%20mapV%20(toIdeal%20.%20map%20(flip%20orderedBy%20Lex%20.%20Poly.polynomial%20.%20M.mapKeys%20(Poly.OrderedMonomial%20.%20Poly.fromList%20sdim%20.%20encodeMonomList%20vars)%20.%20unPolynomial))%20vec%20in%20case%20singInstance%20(slen%20%25+%20sdim)%20of%20SingInstance%20-%3e%20demoteComposed%20$%20Gr.intersection%20ids%20freshVar%20::%20%5bPolynomial%20r%5d%20-%3e%20Variable%20freshVar%20ps%20=%20case%20maximum%20$%20concatMap%20buildVarsList%20ps%20of%20Variable%20c%20Nothing%20-%3e%20Variable%20c%20(Just%201)%20Variable%20c%20(Just%20n)%20-%3e%20Variable%20c%20(Just%20$%20n%20+%201)%20--%20%7c%20Calculate%20saturation%20ideal%20by%20the%20principal%20ideal%20generated%20by%20the%20second%20argument.%20saturationByPrincipalIdeal%20::%20(Groebnerable%20r)%20=%3e%20%5bPolynomial%20r%5d%20-%3e%20Polynomial%20r%20-%3e%20%5bPolynomial%20r%5d%20saturationByPrincipalIdeal%20j%20g%20=%20let%20t%20=%20freshVar%20(g%20:%20j)%20in%20eliminate%20%5bt%5d%20$%20(one%20-%20g%20*%20injectVar%20t)%20:%20j%20--%20%7c%20Calculate%20saturation%20ideal.%20saturationIdeal%20::%20Groebnerable%20r%20=%3e%20%5bPolynomial%20r%5d%20-%3e%20%5bPolynomial%20r%5d%20-%3e%20%5bPolynomial%20r%5d%20saturationIdeal%20i%20g%20=%20intersection%20$%20map%20(i%20%60saturationByPrincipalIdeal%60)%20g%20--%20%7c%20Calculate%20ideal%20quotient%20of%20I%20by%20principal%20ideal%20quotByPrincipalIdeal%20::%20Groebnerable%20r%20=%3e%20%5bPolynomial%20r%5d%20-%3e%20Polynomial%20r%20-%3e%20%5bPolynomial%20r%5d%20quotByPrincipalIdeal%20i%20g%20=%20map%20(snd%20.%20head%20.%20flip%20(divPolynomialWith%20Lex)%20%5bg%5d)%20$%20intersection%20%5bi,%20%5bg%5d%5d%20--%20%7c%20Calculate%20the%20ideal%20quotient%20of%20I%20of%20J.%20quotIdeal%20::%20Groebnerable%20r%20=%3e%20%5bPolynomial%20r%5d%20-%3e%20%5bPolynomial%20r%5d%20-%3e%20%5bPolynomial%20r%5d%20quotIdeal%20i%20g%20=%20intersection%20$%20map%20(i%20%60quotByPrincipalIdeal%60)%20g%20divModPolynomial%20::%20Groebnerable%20r%20=%3e%20Polynomial%20r%20-%3e%20%5bPolynomial%20r%5d%20-%3e%20(%5b(Polynomial%20r,%20Polynomial%20r)%5d,%20Polynomial%20r)%20divModPolynomial%20=%20divModPolynomialWith%20Grevlex%20divModPolynomialWith%20::%20forall%20ord%20r.%20(IsMonomialOrder%20ord,%20Groebnerable%20r)%20=%3e%20ord%20-%3e%20Polynomial%20r%20-%3e%20%5bPolynomial%20r%5d%20-%3e%20(%5b(Polynomial%20r,%20Polynomial%20r)%5d,%20Polynomial%20r)%20divModPolynomialWith%20_%20f%20gs%20=%20case%20promoteList%20(f:gs)%20::%20Monomorphic%20(%5b%5d%20:.:%20Poly.OrderedPolynomial%20r%20ord)%20of%20Monomorphic%20(Comp%20(f'%20:%20gs'))%20-%3e%20let%20sn%20=%20Poly.sDegree%20f'%20in%20case%20singInstance%20sn%20of%20SingInstance%20-%3e%20let%20(q,%20r)%20=%20Gr.divModPolynomial%20f'%20gs'%20in%20(map%20(renameVars%20vars%20.%20polyn%20.%20demote'%20***%20polyn%20.%20demote')%20q,%20polyn%20$%20demote'%20r)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Field</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>NoetherianRing</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span>
<a name="line-37"></a>
<a name="line-38"></a><a name="intersection"></a><span class='hs-comment'>-- | Calculate a intersection of given ideals.</span>
<a name="line-39"></a><span class='hs-definition'>intersection</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<a name="line-40"></a>             <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-41"></a><span class='hs-definition'>intersection</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=</span>
<a name="line-42"></a>  <span class='hs-keyword'>let</span> <span class='hs-varid'>vars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nub</span> <span class='hs-varop'>$</span> <span class='hs-varid'>sort</span> <span class='hs-varop'>$</span> <span class='hs-varid'>concatMap</span> <span class='hs-layout'>(</span><span class='hs-varid'>concatMap</span> <span class='hs-varid'>buildVarsList</span><span class='hs-layout'>)</span> <span class='hs-varid'>ps</span>
<a name="line-43"></a>      <span class='hs-varid'>dim</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>length</span> <span class='hs-varid'>vars</span>
<a name="line-44"></a>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>promote</span> <span class='hs-varid'>dim</span> <span class='hs-keyword'>of</span>
<a name="line-45"></a>       <span class='hs-conid'>Monomorphic</span> <span class='hs-varid'>sdim</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-46"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>singInstance</span> <span class='hs-varid'>sdim</span> <span class='hs-keyword'>of</span>
<a name="line-47"></a>           <span class='hs-conid'>SingInstance</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-48"></a>             <span class='hs-keyword'>case</span> <span class='hs-varid'>promote</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monomorphic</span> <span class='hs-layout'>(</span><span class='hs-conid'>Vector</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-49"></a>               <span class='hs-conid'>Monomorphic</span> <span class='hs-varid'>vec</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-50"></a>                 <span class='hs-keyword'>let</span> <span class='hs-varid'>slen</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sLengthV</span> <span class='hs-varid'>vec</span>
<a name="line-51"></a>                 <span class='hs-keyword'>in</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>singInstance</span> <span class='hs-varid'>slen</span> <span class='hs-keyword'>of</span>
<a name="line-52"></a>                      <span class='hs-conid'>SingInstance</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-53"></a>                        <span class='hs-keyword'>let</span> <span class='hs-varid'>ids</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mapV</span> <span class='hs-layout'>(</span><span class='hs-varid'>toIdeal</span> <span class='hs-varop'>.</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>flip</span> <span class='hs-varid'>orderedBy</span> <span class='hs-conid'>Lex</span> <span class='hs-varop'>.</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-varid'>polynomial</span> <span class='hs-varop'>.</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>mapKeys</span> <span class='hs-layout'>(</span><span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-conid'>OrderedMonomial</span> <span class='hs-varop'>.</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-varid'>fromList</span> <span class='hs-varid'>sdim</span> <span class='hs-varop'>.</span> <span class='hs-varid'>encodeMonomList</span> <span class='hs-varid'>vars</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>unPolynomial</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>vec</span>
<a name="line-54"></a>                        <span class='hs-keyword'>in</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>singInstance</span> <span class='hs-layout'>(</span><span class='hs-varid'>slen</span> <span class='hs-varop'>%+</span> <span class='hs-varid'>sdim</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-55"></a>                             <span class='hs-conid'>SingInstance</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>demoteComposed</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Gr</span><span class='hs-varop'>.</span><span class='hs-varid'>intersection</span> <span class='hs-varid'>ids</span>
<a name="line-56"></a>
<a name="line-57"></a><a name="freshVar"></a><span class='hs-definition'>freshVar</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Variable</span>
<a name="line-58"></a><span class='hs-definition'>freshVar</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=</span>
<a name="line-59"></a>    <span class='hs-keyword'>case</span> <span class='hs-varid'>maximum</span> <span class='hs-varop'>$</span> <span class='hs-varid'>concatMap</span> <span class='hs-varid'>buildVarsList</span> <span class='hs-varid'>ps</span> <span class='hs-keyword'>of</span>
<a name="line-60"></a>      <span class='hs-conid'>Variable</span> <span class='hs-varid'>c</span> <span class='hs-conid'>Nothing</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Variable</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<a name="line-61"></a>      <span class='hs-conid'>Variable</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Variable</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varop'>$</span> <span class='hs-varid'>n</span> <span class='hs-varop'>+</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<a name="line-62"></a>
<a name="line-63"></a><a name="saturationByPrincipalIdeal"></a><span class='hs-comment'>-- | Calculate saturation ideal by the principal ideal generated by the second argument.</span>
<a name="line-64"></a><span class='hs-definition'>saturationByPrincipalIdeal</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<a name="line-65"></a>                           <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-66"></a><span class='hs-definition'>saturationByPrincipalIdeal</span> <span class='hs-varid'>j</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<a name="line-67"></a>  <span class='hs-keyword'>let</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>freshVar</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span> <span class='hs-conop'>:</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-68"></a>  <span class='hs-keyword'>in</span> <span class='hs-varid'>eliminate</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>t</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>one</span> <span class='hs-comment'>-</span> <span class='hs-varid'>g</span> <span class='hs-varop'>*</span> <span class='hs-varid'>injectVar</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>j</span>
<a name="line-69"></a>
<a name="line-70"></a><a name="saturationIdeal"></a><span class='hs-comment'>-- | Calculate saturation ideal.</span>
<a name="line-71"></a><span class='hs-definition'>saturationIdeal</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-72"></a><span class='hs-definition'>saturationIdeal</span> <span class='hs-varid'>i</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>intersection</span> <span class='hs-varop'>$</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>`saturationByPrincipalIdeal`</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<a name="line-73"></a>
<a name="line-74"></a><a name="quotByPrincipalIdeal"></a><span class='hs-comment'>-- | Calculate ideal quotient of I by principal ideal</span>
<a name="line-75"></a><span class='hs-definition'>quotByPrincipalIdeal</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-76"></a><span class='hs-definition'>quotByPrincipalIdeal</span> <span class='hs-varid'>i</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<a name="line-77"></a>  <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>snd</span> <span class='hs-varop'>.</span> <span class='hs-varid'>head</span> <span class='hs-varop'>.</span> <span class='hs-varid'>flip</span> <span class='hs-layout'>(</span><span class='hs-varid'>divPolynomialWith</span> <span class='hs-conid'>Lex</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>g</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>intersection</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>i</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>g</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<a name="line-78"></a>
<a name="line-79"></a><a name="quotIdeal"></a><span class='hs-comment'>-- | Calculate the ideal quotient of I of J.</span>
<a name="line-80"></a><span class='hs-definition'>quotIdeal</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-81"></a><span class='hs-definition'>quotIdeal</span> <span class='hs-varid'>i</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>intersection</span> <span class='hs-varop'>$</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>`quotByPrincipalIdeal`</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<a name="line-82"></a>
<a name="line-83"></a><a name="divModPolynomial"></a><span class='hs-definition'>divModPolynomial</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span>
<a name="line-84"></a>                 <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<a name="line-85"></a><span class='hs-definition'>divModPolynomial</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divModPolynomialWith</span> <span class='hs-conid'>Grevlex</span>
<a name="line-86"></a>
<a name="line-87"></a><a name="divModPolynomialWith"></a><span class='hs-definition'>divModPolynomialWith</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>ord</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>IsMonomialOrder</span> <span class='hs-varid'>ord</span><span class='hs-layout'>,</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<a name="line-88"></a>                     <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>ord</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-89"></a>                     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<a name="line-90"></a><span class='hs-definition'>divModPolynomialWith</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>f</span> <span class='hs-varid'>gs</span> <span class='hs-keyglyph'>=</span>
<a name="line-91"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>promoteList</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-varid'>gs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monomorphic</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span> <span class='hs-conop'>:.:</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-conid'>OrderedPolynomial</span> <span class='hs-varid'>r</span> <span class='hs-varid'>ord</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-92"></a>    <span class='hs-conid'>Monomorphic</span> <span class='hs-layout'>(</span><span class='hs-conid'>Comp</span> <span class='hs-layout'>(</span><span class='hs-varid'>f'</span> <span class='hs-conop'>:</span> <span class='hs-varid'>gs'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-93"></a>      <span class='hs-keyword'>let</span> <span class='hs-varid'>sn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-varid'>sDegree</span> <span class='hs-varid'>f'</span>
<a name="line-94"></a>      <span class='hs-keyword'>in</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>singInstance</span> <span class='hs-varid'>sn</span> <span class='hs-keyword'>of</span>
<a name="line-95"></a>           <span class='hs-conid'>SingInstance</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-96"></a>             <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>q</span><span class='hs-layout'>,</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Gr</span><span class='hs-varop'>.</span><span class='hs-varid'>divModPolynomial</span> <span class='hs-varid'>f'</span> <span class='hs-varid'>gs'</span>
<a name="line-97"></a>             <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>renameVars</span> <span class='hs-varid'>vars</span> <span class='hs-varop'>.</span> <span class='hs-varid'>polyn</span> <span class='hs-varop'>.</span> <span class='hs-varid'>demote'</span> <span class='hs-varop'>***</span> <span class='hs-varid'>polyn</span> <span class='hs-varop'>.</span> <span class='hs-varid'>demote'</span><span class='hs-layout'>)</span> <span class='hs-varid'>q</span><span class='hs-layout'>,</span> <span class='hs-varid'>polyn</span> <span class='hs-varop'>$</span> <span class='hs-varid'>demote'</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<a name="line-98"></a>  <span class='hs-keyword'>where</span>
<a name="line-99"></a>    <span class='hs-varid'>vars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nub</span> <span class='hs-varop'>$</span> <span class='hs-varid'>sort</span> <span class='hs-varop'>$</span> <span class='hs-varid'>concatMap</span> <span class='hs-varid'>buildVarsList</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-varid'>gs</span><span class='hs-layout'>)</span>
<a name="line-100"></a>
<a name="line-101"></a><a name="divPolynomial"></a><span class='hs-definition'>divPolynomial</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-102"></a><span class='hs-definition'>divPolynomial</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>fst</span> <span class='hs-varop'>.</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>divModPolynomial</span>
<a name="line-103"></a>
<a name="line-104"></a><a name="modPolynomial"></a><span class='hs-definition'>modPolynomial</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span>
<a name="line-105"></a><span class='hs-definition'>modPolynomial</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>snd</span> <span class='hs-varop'>.</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>divModPolynomial</span>
<a name="line-106"></a>
<a name="line-107"></a><a name="divPolynomialWith"></a><span class='hs-definition'>divPolynomialWith</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>IsMonomialOrder</span> <span class='hs-varid'>ord</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>ord</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-108"></a><span class='hs-definition'>divPolynomialWith</span> <span class='hs-varid'>ord</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>fst</span> <span class='hs-varop'>.</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>divModPolynomialWith</span> <span class='hs-varid'>ord</span>
<a name="line-109"></a>
<a name="line-110"></a><a name="modPolynomialWith"></a><span class='hs-definition'>modPolynomialWith</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>IsMonomialOrder</span> <span class='hs-varid'>ord</span><span class='hs-layout'>)</span>
<a name="line-111"></a>                  <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>ord</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span>
<a name="line-112"></a><span class='hs-definition'>modPolynomialWith</span> <span class='hs-varid'>ord</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>snd</span> <span class='hs-varop'>.</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>divModPolynomialWith</span> <span class='hs-varid'>ord</span>
<a name="line-113"></a>
<a name="line-114"></a><a name="calcGroebnerBasis"></a><span class='hs-definition'>calcGroebnerBasis</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-115"></a><span class='hs-definition'>calcGroebnerBasis</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>calcGroebnerBasisWith</span> <span class='hs-conid'>Grevlex</span>
<a name="line-116"></a>
<a name="line-117"></a><a name="calcGroebnerBasisWith"></a><span class='hs-definition'>calcGroebnerBasisWith</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>ord</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-conid'>IsMonomialOrder</span> <span class='hs-varid'>ord</span><span class='hs-layout'>)</span>
<a name="line-118"></a>                      <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>ord</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-119"></a><span class='hs-definition'>calcGroebnerBasisWith</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>any</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span> <span class='hs-varid'>zero</span><span class='hs-layout'>)</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-120"></a><span class='hs-definition'>calcGroebnerBasisWith</span> <span class='hs-varid'>ord</span> <span class='hs-varid'>j</span> <span class='hs-keyglyph'>=</span>
<a name="line-121"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>uniformlyPromote</span> <span class='hs-varid'>j</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monomorphic</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ideal</span> <span class='hs-conop'>:.:</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-conid'>OrderedPolynomial</span> <span class='hs-varid'>r</span> <span class='hs-varid'>ord</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-122"></a>    <span class='hs-conid'>Monomorphic</span> <span class='hs-layout'>(</span><span class='hs-conid'>Comp</span> <span class='hs-varid'>ideal</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-123"></a>      <span class='hs-keyword'>case</span> <span class='hs-varid'>ideal</span> <span class='hs-keyword'>of</span>
<a name="line-124"></a>        <span class='hs-conid'>Ideal</span> <span class='hs-varid'>vec</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-125"></a>          <span class='hs-keyword'>case</span> <span class='hs-varid'>singInstance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-varid'>sDegree</span> <span class='hs-layout'>(</span><span class='hs-varid'>head</span> <span class='hs-varop'>$</span> <span class='hs-varid'>toList</span> <span class='hs-varid'>vec</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-126"></a>            <span class='hs-conid'>SingInstance</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>renameVars</span> <span class='hs-varid'>vars</span> <span class='hs-varop'>.</span> <span class='hs-varid'>polyn</span> <span class='hs-varop'>.</span> <span class='hs-varid'>demote</span> <span class='hs-varop'>.</span> <span class='hs-conid'>Monomorphic</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Gr</span><span class='hs-varop'>.</span><span class='hs-varid'>calcGroebnerBasisWith</span> <span class='hs-varid'>ord</span> <span class='hs-varid'>ideal</span>
<a name="line-127"></a>  <span class='hs-keyword'>where</span>
<a name="line-128"></a>    <span class='hs-varid'>vars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nub</span> <span class='hs-varop'>$</span> <span class='hs-varid'>sort</span> <span class='hs-varop'>$</span> <span class='hs-varid'>concatMap</span> <span class='hs-varid'>buildVarsList</span> <span class='hs-varid'>j</span>
<a name="line-129"></a>
<a name="line-130"></a><a name="isIdealMember"></a><span class='hs-definition'>isIdealMember</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-131"></a><span class='hs-definition'>isIdealMember</span> <span class='hs-varid'>f</span> <span class='hs-varid'>ideal</span> <span class='hs-keyglyph'>=</span>
<a name="line-132"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>promoteList</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-varid'>ideal</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monomorphic</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span> <span class='hs-conop'>:.:</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-133"></a>    <span class='hs-conid'>Monomorphic</span> <span class='hs-layout'>(</span><span class='hs-conid'>Comp</span> <span class='hs-layout'>(</span><span class='hs-varid'>f'</span><span class='hs-conop'>:</span><span class='hs-varid'>ideal'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-134"></a>      <span class='hs-keyword'>case</span> <span class='hs-varid'>singInstance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-varid'>sDegree</span> <span class='hs-varid'>f'</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-135"></a>        <span class='hs-conid'>SingInstance</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Gr</span><span class='hs-varop'>.</span><span class='hs-varid'>isIdealMember</span> <span class='hs-varid'>f'</span> <span class='hs-layout'>(</span><span class='hs-varid'>toIdeal</span> <span class='hs-varid'>ideal'</span><span class='hs-layout'>)</span>
<a name="line-136"></a>    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>error</span> <span class='hs-str'>"impossible happend!"</span>
<a name="line-137"></a>
<a name="line-138"></a><a name="eliminate"></a><span class='hs-comment'>-- | Computes the ideal with specified variables eliminated.</span>
<a name="line-139"></a><span class='hs-definition'>eliminate</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Variable</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-140"></a><span class='hs-definition'>eliminate</span> <span class='hs-varid'>elvs</span> <span class='hs-varid'>j</span> <span class='hs-keyglyph'>=</span>
<a name="line-141"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>promoteListWithVarOrder</span> <span class='hs-layout'>(</span><span class='hs-varid'>els</span> <span class='hs-varop'>++</span> <span class='hs-varid'>rest</span><span class='hs-layout'>)</span> <span class='hs-varid'>j</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monomorphic</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span> <span class='hs-conop'>:.:</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-conid'>OrderedPolynomial</span> <span class='hs-varid'>r</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-conid'>Lex</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-142"></a>    <span class='hs-conid'>Monomorphic</span> <span class='hs-layout'>(</span><span class='hs-conid'>Comp</span> <span class='hs-varid'>fs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-143"></a>      <span class='hs-keyword'>case</span> <span class='hs-varid'>promote</span> <span class='hs-varid'>k</span> <span class='hs-keyword'>of</span>
<a name="line-144"></a>        <span class='hs-conid'>Monomorphic</span> <span class='hs-varid'>sk</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-145"></a>          <span class='hs-keyword'>let</span> <span class='hs-varid'>sdim</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-varid'>sDegree</span> <span class='hs-varop'>$</span> <span class='hs-varid'>head</span> <span class='hs-varid'>fs</span>
<a name="line-146"></a>              <span class='hs-varid'>newDim</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sMax</span> <span class='hs-varid'>sk</span> <span class='hs-varid'>sdim</span>
<a name="line-147"></a>          <span class='hs-keyword'>in</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>singInstance</span> <span class='hs-varid'>sdim</span> <span class='hs-keyword'>of</span>
<a name="line-148"></a>               <span class='hs-conid'>SingInstance</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-149"></a>                 <span class='hs-keyword'>case</span> <span class='hs-varid'>propToClassLeq</span> <span class='hs-varop'>$</span> <span class='hs-varid'>maxLeqR</span> <span class='hs-varid'>sk</span> <span class='hs-varid'>sdim</span> <span class='hs-keyword'>of</span>
<a name="line-150"></a>                   <span class='hs-conid'>LeqInstance</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-151"></a>                     <span class='hs-keyword'>case</span> <span class='hs-varid'>singInstance</span> <span class='hs-varid'>newDim</span> <span class='hs-keyword'>of</span>
<a name="line-152"></a>                       <span class='hs-conid'>SingInstance</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-153"></a>                         <span class='hs-keyword'>let</span> <span class='hs-varid'>fs'</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>flip</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-varid'>orderedBy</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-conid'>Lex</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-conid'>Poly</span><span class='hs-varop'>.</span><span class='hs-varid'>scastPolynomial</span> <span class='hs-varid'>newDim</span><span class='hs-layout'>)</span> <span class='hs-varid'>fs</span>
<a name="line-154"></a>                         <span class='hs-keyword'>in</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>propToBoolLeq</span> <span class='hs-varop'>$</span> <span class='hs-varid'>maxLeqL</span> <span class='hs-varid'>sk</span> <span class='hs-varid'>sdim</span> <span class='hs-keyword'>of</span>
<a name="line-155"></a>                              <span class='hs-conid'>LeqTrueInstance</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-156"></a>                                <span class='hs-keyword'>case</span> <span class='hs-varid'>singInstance</span> <span class='hs-layout'>(</span><span class='hs-varid'>newDim</span> <span class='hs-varop'>%-</span> <span class='hs-varid'>sk</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-157"></a>                                  <span class='hs-conid'>SingInstance</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-158"></a>                                    <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>renameVars</span> <span class='hs-varid'>rest</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>demoteComposed</span> <span class='hs-varop'>$</span> <span class='hs-varid'>sk</span> <span class='hs-varop'>`</span><span class='hs-conid'>Gr</span><span class='hs-varop'>.</span><span class='hs-varid'>thEliminationIdeal</span><span class='hs-varop'>`</span> <span class='hs-varid'>toIdeal</span> <span class='hs-varid'>fs'</span>
<a name="line-159"></a>  <span class='hs-keyword'>where</span>
<a name="line-160"></a>    <span class='hs-varid'>vars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nub</span> <span class='hs-varop'>$</span> <span class='hs-varid'>sort</span> <span class='hs-varop'>$</span> <span class='hs-varid'>concatMap</span> <span class='hs-varid'>buildVarsList</span> <span class='hs-varid'>j</span>
<a name="line-161"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>els</span><span class='hs-layout'>,</span> <span class='hs-varid'>rest</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>partition</span> <span class='hs-layout'>(</span><span class='hs-varop'>`elem`</span> <span class='hs-varid'>elvs</span><span class='hs-layout'>)</span> <span class='hs-varid'>vars</span>
<a name="line-162"></a>    <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>length</span> <span class='hs-varid'>els</span>
<a name="line-163"></a>
<a name="line-164"></a><a name="thEliminationIdeal"></a><span class='hs-comment'>-- | Computes nth elimination ideal.</span>
<a name="line-165"></a><span class='hs-definition'>thEliminationIdeal</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Groebnerable</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Polynomial</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>]</span>
<a name="line-166"></a><span class='hs-definition'>thEliminationIdeal</span> <span class='hs-varid'>k</span> <span class='hs-varid'>j</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>eliminate</span> <span class='hs-layout'>(</span><span class='hs-varid'>take</span> <span class='hs-varid'>k</span> <span class='hs-varid'>vars</span><span class='hs-layout'>)</span> <span class='hs-varid'>j</span>
<a name="line-167"></a>  <span class='hs-keyword'>where</span>
<a name="line-168"></a>    <span class='hs-varid'>vars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nub</span> <span class='hs-varop'>$</span> <span class='hs-varid'>sort</span> <span class='hs-varop'>$</span> <span class='hs-varid'>concatMap</span> <span class='hs-varid'>buildVarsList</span> <span class='hs-varid'>j</span>
</pre></body>
</html>
